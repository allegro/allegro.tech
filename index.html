<!DOCTYPE html><html lang="pl"><head><meta charSet="utf-8"/><link rel="prefetch" href="https://allegrotechio.disqus.com/count.js"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="Allegro Tech to miejsce, w którym nasi inżynierowie dzielą się wiedzą oraz case study z wybranych projektów w firmie - w formie artykułów, podcastów oraz eventów."/><title>Allegro Tech</title><meta property="og:site_name" content="allegro.tech"/><meta property="og:title" content="allegro.tech"/><meta property="og:url" content="https://allegro.tech"/><meta property="og:type" content="site"/><meta property="og:image" content="https://allegro.tech/images/allegro-tech.png"/><link rel="shortcut icon" href="favicon.ico"/><link rel="canonical" href="https://allegro.tech" itemProp="url"/><link rel="preload" href="images/splash.jpg" as="image"/><link rel="author" href="humans.txt"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1M1FJ5PXWW"></script><script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){dataLayer.push(arguments);}
                    gtag('js', new Date());
                    gtag('config', 'G-1M1FJ5PXWW');
                </script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/c4277531f90028a4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c4277531f90028a4.css" data-n-g=""/><link rel="preload" href="/_next/static/css/79db8b1e27b0a093.css" as="style"/><link rel="stylesheet" href="/_next/static/css/79db8b1e27b0a093.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-e70c6273bfe3f237.js" defer=""></script><script src="/_next/static/chunks/main-f635b472c367d1c7.js" defer=""></script><script src="/_next/static/chunks/pages/_app-179adf437ae674f2.js" defer=""></script><script src="/_next/static/chunks/206-3a56e5ded293e83e.js" defer=""></script><script src="/_next/static/chunks/pages/index-9e9857288e1eab25.js" defer=""></script><script src="/_next/static/vRW38edfpPonFFwKo-sNV/_buildManifest.js" defer=""></script><script src="/_next/static/vRW38edfpPonFFwKo-sNV/_ssgManifest.js" defer=""></script><script src="/_next/static/vRW38edfpPonFFwKo-sNV/_middlewareManifest.js" defer=""></script></head><body class="m-color-bg_desk"><div id="__next" data-reactroot=""><header class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card Header_navbar__Zc5aN m-color-bg_card"><nav class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-display-flex m-flex-justify-between m-flex-items-center"><a href="/"><img src="images/logo.svg" alt="Allegro Tech" width="205" height="45"/></a><div><ul class="m-font-family_sans m-font-size_14 m-line-height_21 m-color_text m-text-size-adjust_100p m-list-style-type_none m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-padding-top_0 m-padding-right_0 m-padding-bottom_0 m-padding-left_0 m-display-flex@lg m-display-none"><li class="m-margin-left-16@lg"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display-block m-display-inline@lg m-padding-left-16 m-padding-right-16 m-padding-top-16 m-padding-bottom-16 m-padding-left-0@lg m-padding-top-0@lg m-padding-right-0@lg m-padding-bottom-0@lg m-link--signal m-line-height_21" href="https://blog.allegro.tech">Blog</a></li><li class="m-margin-left-16@lg"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display-block m-display-inline@lg m-padding-left-16 m-padding-right-16 m-padding-top-16 m-padding-bottom-16 m-padding-left-0@lg m-padding-top-0@lg m-padding-right-0@lg m-padding-bottom-0@lg m-link--signal m-line-height_21" href="https://ml.allegro.tech">Machine Learning</a></li><li class="m-margin-left-16@lg"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display-block m-display-inline@lg m-padding-left-16 m-padding-right-16 m-padding-top-16 m-padding-bottom-16 m-padding-left-0@lg m-padding-top-0@lg m-padding-right-0@lg m-padding-bottom-0@lg m-link--signal m-line-height_21" href="https://podcast.allegro.tech">Podcast</a></li><li class="m-margin-left-16@lg"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display-block m-display-inline@lg m-padding-left-16 m-padding-right-16 m-padding-top-16 m-padding-bottom-16 m-padding-left-0@lg m-padding-top-0@lg m-padding-right-0@lg m-padding-bottom-0@lg m-link--signal m-line-height_21" href="https://github.com/Allegro">Open Source</a></li><li class="m-margin-left-16@lg"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display-block m-display-inline@lg m-padding-left-16 m-padding-right-16 m-padding-top-16 m-padding-bottom-16 m-padding-left-0@lg m-padding-top-0@lg m-padding-right-0@lg m-padding-bottom-0@lg m-link--signal m-line-height_21" href="https://www.meetup.com/allegrotech/events">Wydarzenia</a></li><li class="m-margin-left-16@lg"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display-block m-display-inline@lg m-padding-left-16 m-padding-right-16 m-padding-top-16 m-padding-bottom-16 m-padding-left-0@lg m-padding-top-0@lg m-padding-right-0@lg m-padding-bottom-0@lg m-link--signal m-line-height_21" href="https://praca.allegro.pl">Praca</a></li></ul><button class="m-display-none@lg m-height_40 m-line-height_40 m-border-style-top_none m-border-style-right_none m-border-style-bottom_none m-border-style-left_none m-border-radius-top-left_2 m-border-radius-top-right_2 m-border-radius-bottom-left_2 m-border-radius-bottom-right_2 m-cursor_pointer m-overflow_hidden m-appearance_none m-padding-left_4 m-padding-right_4 m-padding-top_4 m-padding-bottom_4 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button" style="background:transparent" aria-label="Otwórz menu"><img src="https://assets.allegrostatic.com/metrum/icon/menu-23e046bf68.svg" alt="" class="m-icon" width="32" height="32"/></button></div></nav></header><div class="Header_hero__PYE0B"><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-display-flex m-flex-column m-flex-justify-end Header_image__Cj6ZF"><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-color-bg_desk"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text  m-font-weight_100 m-font-size_32 m-font-size_43_sm m-margin-bottom_16 m-margin-bottom_24_sm m-line-height_125">About us</h2><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text">Allegro is one of the most technologically advanced companies in our part of Europe. Allegro is also over 1700 IT specialists of various specializations, developing our website. The unique scale and complexity of the problems that we solve on a daily basis give us the opportunity to develop on a wide variety of projects. Allegro Tech is a place where our engineers share knowledge and case studies from selected projects in the company – in the form of articles, podcasts and events.</p></div></div></div><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-padding-top-24"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_300 m-font-size_27 m-font-size_36_sm m-margin-bottom_16 m-margin-bottom_24_sm m-line-height_125 m-padding-left-24 m-padding-right-24">Blog</h2><div class="m-display_flex m-flex-wrap_1 m-flex-grow_1 m-grid"><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://blog.allegro.tech/2023/11/how-does-btree-make-your-queries-fast.html" title="How does B-tree make your queries fast?"><img width="388" src="images/post-headers/default.jpg" alt="How does B-tree make your queries fast?" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://blog.allegro.tech/2023/11/how-does-btree-make-your-queries-fast.html" title="How does B-tree make your queries fast?" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">How does B-tree make your queries fast?</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">9 dni temu</time><ul class="m-font-family_sans m-font-size_14 m-line-height_21 m-color_text m-text-size-adjust_100p m-list-style-type_none m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-padding-top_0 m-padding-right_0 m-padding-bottom_0 m-padding-left_0"><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/tech">#<!-- -->tech</a></li></ul><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1 m-padding-top-16">B-tree is a structure that helps to search through great amounts of data.
It was invented over 40 years ago, yet it is still employed by…</p><div class="m-display-flex m-flex-justify-between m-padding-top-16 m-flex-items_center"><div class="m-display-flex m-flex-items_center"><div class="MuiAvatarGroup-root m-padding-right_16 Post_avatars__FHMgb"><div class="MuiAvatar-root MuiAvatar-circle MuiAvatarGroup-avatar" style="z-index:1"><img alt="Mateusz Kuźmik" src="https://blog.allegro.tech/img/authors/mateusz.kuzmik.jpg" class="MuiAvatar-img" width="32" height="32"/></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/authors/mateusz.kuzmik">Mateusz Kuźmik</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/2023/11/how-does-btree-make-your-queries-fast.html#disqus_thread">0 Comments</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://blog.allegro.tech/2023/11/how-does-btree-make-your-queries-fast.html">przejdź do wpisu</a></div></article></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://blog.allegro.tech/2023/10/battle-against-knowledge-loss.html" title="Beyond the Code - An Engineer’s Battle Against Knowledge Loss"><img width="388" src="images/post-headers/eventstorming.png" alt="Beyond the Code - An Engineer’s Battle Against Knowledge Loss" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://blog.allegro.tech/2023/10/battle-against-knowledge-loss.html" title="Beyond the Code - An Engineer’s Battle Against Knowledge Loss" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">Beyond the Code - An Engineer’s Battle Against Knowledge Loss</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">około miesiąc temu</time><ul class="m-font-family_sans m-font-size_14 m-line-height_21 m-color_text m-text-size-adjust_100p m-list-style-type_none m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-padding-top_0 m-padding-right_0 m-padding-bottom_0 m-padding-left_0"><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/eventstorming">#<!-- -->eventstorming</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/knowledge-preservation">#<!-- -->knowledge-preservation</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/tech">#<!-- -->tech</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/communication">#<!-- -->communication</a></li></ul><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1 m-padding-top-16">The idea for this article arose during a meeting where we learned that our supervisor would be leaving the company to pursue new opportunities. In…</p><div class="m-display-flex m-flex-justify-between m-padding-top-16 m-flex-items_center"><div class="m-display-flex m-flex-items_center"><div class="MuiAvatarGroup-root m-padding-right_16 Post_avatars__FHMgb"><div class="MuiAvatar-root MuiAvatar-circle MuiAvatarGroup-avatar" style="z-index:1"><img alt="Krzysztof Przychodzki" src="https://blog.allegro.tech/img/authors/krzysztof.przychodzki.jpg" class="MuiAvatar-img" width="32" height="32"/></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/authors/krzysztof.przychodzki">Krzysztof Przychodzki</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/2023/10/battle-against-knowledge-loss.html#disqus_thread">0 Comments</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://blog.allegro.tech/2023/10/battle-against-knowledge-loss.html">przejdź do wpisu</a></div></article></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://blog.allegro.tech/2023/09/online-mongodb-migration.html" title="Online MongoDB migration"><img width="388" src="images/post-headers/mongodb.png" alt="Online MongoDB migration" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://blog.allegro.tech/2023/09/online-mongodb-migration.html" title="Online MongoDB migration" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">Online MongoDB migration</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">3 miesiące temu</time><ul class="m-font-family_sans m-font-size_14 m-line-height_21 m-color_text m-text-size-adjust_100p m-list-style-type_none m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-padding-top_0 m-padding-right_0 m-padding-bottom_0 m-padding-left_0"><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/tech">#<!-- -->tech</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/mongodb">#<!-- -->mongodb</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/nosql">#<!-- -->nosql</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/kotlin">#<!-- -->kotlin</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/open source">#<!-- -->open source</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/mongo change streams">#<!-- -->mongo change streams</a></li></ul><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1 m-padding-top-16">MongoDB is the most popular database used at Allegro. We have hundreds of MongoDB databases running on our on—premise servers.
In 2022 we decided that we…</p><div class="m-display-flex m-flex-justify-between m-padding-top-16 m-flex-items_center"><div class="m-display-flex m-flex-items_center"><div class="MuiAvatarGroup-root m-padding-right_16 Post_avatars__FHMgb"><div class="MuiAvatar-root MuiAvatar-circle MuiAvatarGroup-avatar" style="z-index:1"><img alt="Szymon Marcinkiewicz" src="https://blog.allegro.tech/img/authors/szymon.marcinkiewicz.jpg" class="MuiAvatar-img" width="32" height="32"/></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/authors/szymon.marcinkiewicz">Szymon Marcinkiewicz</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/2023/09/online-mongodb-migration.html#disqus_thread">0 Comments</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://blog.allegro.tech/2023/09/online-mongodb-migration.html">przejdź do wpisu</a></div></article></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://blog.allegro.tech/2023/08/management-engineering-acrobatics.html" title="The Acrobatics of Switching Between Management and Engineering"><img width="388" src="images/post-headers/default.jpg" alt="The Acrobatics of Switching Between Management and Engineering" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://blog.allegro.tech/2023/08/management-engineering-acrobatics.html" title="The Acrobatics of Switching Between Management and Engineering" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">The Acrobatics of Switching Between Management and Engineering</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">4 miesiące temu</time><ul class="m-font-family_sans m-font-size_14 m-line-height_21 m-color_text m-text-size-adjust_100p m-list-style-type_none m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-padding-top_0 m-padding-right_0 m-padding-bottom_0 m-padding-left_0"><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/tech">#<!-- -->tech</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/coding">#<!-- -->coding</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/management">#<!-- -->management</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/developer">#<!-- -->developer</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/team leader">#<!-- -->team leader</a></li><li class="m-margin-right-8 m-display-inline-block"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/hashtag/career path">#<!-- -->career path</a></li></ul><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1 m-padding-top-16">After six years as a Team Leader, I went back to hands-on engineering work, and I’m very happy about taking
this step. While it may appear…</p><div class="m-display-flex m-flex-justify-between m-padding-top-16 m-flex-items_center"><div class="m-display-flex m-flex-items_center"><div class="MuiAvatarGroup-root m-padding-right_16 Post_avatars__FHMgb"><div class="MuiAvatar-root MuiAvatar-circle MuiAvatarGroup-avatar" style="z-index:1"><img alt="Michał Kosmulski" src="https://blog.allegro.tech/img/authors/michal.kosmulski.jpg" class="MuiAvatar-img" width="32" height="32"/></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/authors/michal.kosmulski">Michał Kosmulski</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://blog.allegro.tech/2023/08/management-engineering-acrobatics.html#disqus_thread">0 Comments</a></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://blog.allegro.tech/2023/08/management-engineering-acrobatics.html">przejdź do wpisu</a></div></article></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display_block m-margin-bottom_8 m-width_100 m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://blog.allegro.tech">Zobacz więcej wpisów</a></div><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-padding-top-24"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_300 m-font-size_27 m-font-size_36_sm m-margin-bottom_16 m-margin-bottom_24_sm m-line-height_125 m-padding-left-24 m-padding-right-24">Podcasty</h2><div class="m-display_flex m-flex-wrap_1 m-flex-grow_1 m-grid"><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://podcast.allegro.tech/mbox-server-driven-ui-dla-aplikacji-mobilnych/" title="MBox: server-driven UI dla aplikacji mobilnych"><img src="images/podcast.png" alt="MBox: server-driven UI dla aplikacji mobilnych" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://podcast.allegro.tech/mbox-server-driven-ui-dla-aplikacji-mobilnych/" title="MBox: server-driven UI dla aplikacji mobilnych" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">MBox: server-driven UI dla aplikacji mobilnych</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">20 dni temu</time><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1">Czym jest i jak powstał MBox: wewnętrzna platforma server-driven UI dla aplikacji mobilnych w Allegro? Skąd wziął się pomysł na to rozwiązanie i na jakie bolączki odpowiada? Dlaczego zdecydowaliśmy się na budowanie tego typu rozwiązania in-house i z jakimi wyzwaniami mierzyliśmy się w procesie tworzenia? Co wyróżnia zespoły pracujące nad tym narzędziem i jak pracuje im się bez Product Ownera? Posłuchajcie siódmego odcinka Allegro Tech Podcast z udziałem Pauliny Sadowskiej i Tomasza Gębarowskiego - Managerów w obszarze Technical Platform Services w Allegro.</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://podcast.allegro.tech/mbox-server-driven-ui-dla-aplikacji-mobilnych/">Posłuchaj odcinka</a></div></article></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://podcast.allegro.tech/o-chatbotach-i-ich-wplywie-na-allegro/" title="O chatbotach i ich wpływie na Allegro"><img src="images/podcast.png" alt="O chatbotach i ich wpływie na Allegro" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://podcast.allegro.tech/o-chatbotach-i-ich-wplywie-na-allegro/" title="O chatbotach i ich wpływie na Allegro" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">O chatbotach i ich wpływie na Allegro</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">około 2 miesiące temu</time><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1">Jakie procesy automatyzujemy w Allegro i co warto o nich wiedzieć w kontekście obszaru Customer Experience? W czym pomagają nam chatboty, jak je rozwijamy i dbamy o ich jakość? Kim są Allina oraz Albert i co mają wspólnego z automatyzacją? Za jakie rozwiązania otrzymaliśmy nagrodę hiperautomatyzacji? O tym wszystkim posłuchacie w odcinku z udziałem Rafała Gajewskiego - Managera w obszarze IT Services w Allegro.</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://podcast.allegro.tech/o-chatbotach-i-ich-wplywie-na-allegro/">Posłuchaj odcinka</a></div></article></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://podcast.allegro.tech/o-roli-analitykow-biznesowych-w-allegro/" title="O roli analityków biznesowych w Allegro"><img src="images/podcast.png" alt="O roli analityków biznesowych w Allegro" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://podcast.allegro.tech/o-roli-analitykow-biznesowych-w-allegro/" title="O roli analityków biznesowych w Allegro" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">O roli analityków biznesowych w Allegro</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">3 miesiące temu</time><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1">Czym zajmują się analitycy danych w Allegro i za jakie projekty odpowiadają? Z jakich rodzajów danych i narzędzi korzystają w codziennej pracy? Jakie (przykładowe) obszary tematyczne pokrywamy danymi, które analizujemy w Allegro? Jakich umiejętności szukamy u analityków biznesowych w Allegro i jak można do nas dołączyć? O roli analityków biznesowych i pracy w skali Allegro opowiadają Jakub Król i Mateusz Falkowski - Senior Data Analysts w Allegro.</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://podcast.allegro.tech/o-roli-analitykow-biznesowych-w-allegro/">Posłuchaj odcinka</a></div></article></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--3@xl m-display-flex m-flex-direction_column"><article class="m-margin-bottom_16 m-display-flex m-flex-column m-flex-grow_1"><a href="https://podcast.allegro.tech/o-spolecznosci-allegro-tech-i-rozwoju-inzynierow-w-allegro/" title="O społeczności Allegro Tech i rozwoju inżynierów w Allegro"><img src="images/podcast.png" alt="O społeczności Allegro Tech i rozwoju inżynierów w Allegro" class="m-display-block m-width-fluid"/></a><div class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-column m-flex-grow_1 m-padding-bottom-0 m-color-bg_card"><a href="https://podcast.allegro.tech/o-spolecznosci-allegro-tech-i-rozwoju-inzynierow-w-allegro/" title="O społeczności Allegro Tech i rozwoju inżynierów w Allegro" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">O społeczności Allegro Tech i rozwoju inżynierów w Allegro</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-bottom-16">4 miesiące temu</time><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-flex-grow-1">Na czym polega rola Principal Software Engineera w Allegro oraz co ma wspólnego z rozwijaniem siebie i dzieleniem się wiedzą? Co warto wiedzieć o turystyce, która pojawia się niemal w każdym odcinku naszych podcastów? Na czym polega, kto, kiedy i jak może z niej skorzystać? Jak pracujemy z talentami Gallupa (także w zespołach technicznych)?  Co dają nam wewnętrzne DevDays, hackhathony, gildie, meetupy, konferencje i jak jeszcze wymieniamy się doświadczeniami? Czym jest Allegro Tech Meeting i jaka idea mu przyświeca? O społeczności Allegro Tech i możliwościach rozwoju w Allegro z perspektywy inżynierów rozmawialiśmy z Marcinem Turkiem i Michałem Kosmulskim.</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://podcast.allegro.tech/o-spolecznosci-allegro-tech-i-rozwoju-inzynierow-w-allegro/">Posłuchaj odcinka</a></div></article></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display_block m-margin-bottom_8 m-width_100 m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://podcast.allegro.tech">Zobacz więcej podcastów</a></div><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-padding-top-24"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_300 m-font-size_27 m-font-size_36_sm m-margin-bottom_16 m-margin-bottom_24_sm m-line-height_125 m-padding-left-24 m-padding-right-24">Wydarzenia</h2><div class="m-display_flex m-flex-wrap_1 m-flex-grow_1 m-grid"><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--6@xl m-display-flex m-flex-direction_column"><div class="m-margin-bottom_16 m-display-flex m-flex-direction_column m-flex-direction_row_sm m-padding-bottom_0"><a href="https://www.meetup.com/allegrotech/events/297614064/" title="Allegro Tech Talks #40 - Testy: dynamiczne dashboardy &amp; optymalizacja pracy" class="m-display_none m-display_block_lg" style="background-color:#fd4a02"><img width="218" src="images/event.png" alt="Allegro Tech Talks #40 - Testy: dynamiczne dashboardy &amp; optymalizacja pracy"/></a><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-direction_column m-padding-bottom_0 m-flex_1 m-flex-justify_between m-color-bg_card"><a href="https://www.meetup.com/allegrotech/events/297614064/" title="Allegro Tech Talks #40 - Testy: dynamiczne dashboardy &amp; optymalizacja pracy" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">Allegro Tech Talks #40 - Testy: dynamiczne dashboardy &amp; optymalizacja pracy</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text">za 1 dzień<!-- -->, Allegro Kraków Office</time><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-top-8">**➡ Rejestracja:** [https://app.evenea.pl/event/allegro-tech-talk-40/](https://app.evenea.pl/event/allegro-tech-talk-40/) Jeszcze przed świętami zapraszamy Was na #40 wydarzenie z serii Allegro Tech Talk, podczas których dzielimy się wiedzą, wzajemnie inspirujemy oraz integrujemy…</time><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.meetup.com/allegrotech/events/297614064/">Szczegóły</a></article></div></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--6@xl m-display-flex m-flex-direction_column"><div class="m-margin-bottom_16 m-display-flex m-flex-direction_column m-flex-direction_row_sm m-padding-bottom_0"><a href="https://www.meetup.com/allegrotech/events/297480100/" title="Allegro Tech Talks #39 - Big Data: o podejściu do pracy z danymi" class="m-display_none m-display_block_lg" style="background-color:#fd4a02"><img width="218" src="images/event.png" alt="Allegro Tech Talks #39 - Big Data: o podejściu do pracy z danymi"/></a><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-direction_column m-padding-bottom_0 m-flex_1 m-flex-justify_between m-color-bg_card"><a href="https://www.meetup.com/allegrotech/events/297480100/" title="Allegro Tech Talks #39 - Big Data: o podejściu do pracy z danymi" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">Allegro Tech Talks #39 - Big Data: o podejściu do pracy z danymi</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text">6 dni temu<!-- -->, Allegro Warsaw Office</time><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-top-8">**Rejestracja: [https://app.evenea.pl/event/allegro-tech-talk-39/](https://app.evenea.pl/event/allegro-tech-talk-39/)** Bądźcie z nami podczas #39 wydarzenia z serii **Allegro Tech Talk**, podczas których dzielimy się wiedzą, wzajemnie inspirujemy oraz integrujemy podczas rozmów przy…</time><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.meetup.com/allegrotech/events/297480100/">Szczegóły</a></article></div></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--6@xl m-display-flex m-flex-direction_column"><div class="m-margin-bottom_16 m-display-flex m-flex-direction_column m-flex-direction_row_sm m-padding-bottom_0"><a href="https://www.meetup.com/allegrotech/events/293929321/" title="Allegro Tech Talks #38 - Mobile: o iOS bez spinki" class="m-display_none m-display_block_lg" style="background-color:#fd4a02"><img width="218" src="images/event.png" alt="Allegro Tech Talks #38 - Mobile: o iOS bez spinki"/></a><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-direction_column m-padding-bottom_0 m-flex_1 m-flex-justify_between m-color-bg_card"><a href="https://www.meetup.com/allegrotech/events/293929321/" title="Allegro Tech Talks #38 - Mobile: o iOS bez spinki" class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">Allegro Tech Talks #38 - Mobile: o iOS bez spinki</h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text">6 miesięcy temu<!-- -->, Allegro Warsaw Office</time><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-top-8">**➡ Rejestracja:** [https://app.evenea.pl/event/allegro-tech-talk-38/](https://app.evenea.pl/event/allegro-tech-talk-38/) Ostatnie przed przerwą wakacyjną, stacjonarne spotkanie z cyklu Allegro Tech Talks, na których dzielimy się wiedzą, wzajemnie inspirujemy oraz integrujemy podczas rozmów…</time><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.meetup.com/allegrotech/events/293929321/">Szczegóły</a></article></div></div><div class="m-grid__col m-grid__col--12 m-grid__col--6@sm m-grid__col--6@xl m-display-flex m-flex-direction_column"><div class="m-margin-bottom_16 m-display-flex m-flex-direction_column m-flex-direction_row_sm m-padding-bottom_0"><a href="https://www.meetup.com/allegrotech/events/292278882/" title="UX Research Confetti - III edycja " class="m-display_none m-display_block_lg" style="background-color:#fd4a02"><img width="218" src="images/event.png" alt="UX Research Confetti - III edycja "/></a><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-display-flex m-flex-direction_column m-padding-bottom_0 m-flex_1 m-flex-justify_between m-color-bg_card"><a href="https://www.meetup.com/allegrotech/events/292278882/" title="UX Research Confetti - III edycja " class="m-text-decoration_none"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm" style="text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;min-height:2em;overflow:hidden">UX Research Confetti - III edycja </h2></a><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text">7 miesięcy temu</time><time class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-padding-top-8">**Rejestracja na wydarzenie ➡ [https://app.evenea.pl/event/ux-research-confetti-3/]( https://app.evenea.pl/event/ux-research-confetti-3/ )**[ ]( https://app.evenea.pl/event/ux-research-confetti-3/ ) **🎉 Przedstawiamy 3. edycję UX Research Confetti organizowaną przez Allegro - bezpłatną, polską konferencję poświęconą badaniom…</time><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-margin-top-16 m-display_block m-border-width_1 m-border-color_gray m-border-style-top_solid m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.meetup.com/allegrotech/events/292278882/">Szczegóły</a></article></div></div></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display_block m-margin-bottom_8 m-width_100 m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.meetup.com/allegrotech/events/">Zobacz więcej wydarzeń</a></div><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-padding-top-24"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_300 m-font-size_27 m-font-size_36_sm m-margin-bottom_16 m-margin-bottom_24_sm m-line-height_125 m-padding-left-24 m-padding-right-24">Oferty pracy</h2><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto"><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-margin-bottom_16 m-display-flex m-flex-justify_between m-flex-items-center m-flex-direction_column m-flex-direction_row_md m-color-bg_card"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm m-margin-bottom_0_sm m-flex-grow_1">Integration Engineer</h2><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-font-size_21 m-font-size_25_sm m-font-weight_300 m-line-height_normal m-margin-top_16 m-text-align_left m-padding-right_16">Warsaw, Poznań, Cracow, Gdańsk, Wroclaw</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.smartrecruiters.com/Allegro/743999948427702-integration-engineer?trid=de9dfdf3-7f9e-4ebf-8a64-49f6c69ad640">Sprawdź</a></article><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-margin-bottom_16 m-display-flex m-flex-justify_between m-flex-items-center m-flex-direction_column m-flex-direction_row_md m-color-bg_card"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm m-margin-bottom_0_sm m-flex-grow_1">Software Engineer (.NET) - Allegro Pay</h2><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-font-size_21 m-font-size_25_sm m-font-weight_300 m-line-height_normal m-margin-top_16 m-text-align_left m-padding-right_16">Warsaw</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.smartrecruiters.com/Allegro/743999948395138-software-engineer-net-allegro-pay?trid=de9dfdf3-7f9e-4ebf-8a64-49f6c69ad640">Sprawdź</a></article><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-margin-bottom_16 m-display-flex m-flex-justify_between m-flex-items-center m-flex-direction_column m-flex-direction_row_md m-color-bg_card"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm m-margin-bottom_0_sm m-flex-grow_1">DevOps Engineer (Azure / .NET) - Allegro Pay</h2><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-font-size_21 m-font-size_25_sm m-font-weight_300 m-line-height_normal m-margin-top_16 m-text-align_left m-padding-right_16">Warsaw</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.smartrecruiters.com/Allegro/743999947819422-devops-engineer-azure-net-allegro-pay?trid=de9dfdf3-7f9e-4ebf-8a64-49f6c69ad640">Sprawdź</a></article><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-margin-bottom_16 m-display-flex m-flex-justify_between m-flex-items-center m-flex-direction_column m-flex-direction_row_md m-color-bg_card"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm m-margin-bottom_0_sm m-flex-grow_1">Mobile Software Engineer (Android)-Allegro Pay</h2><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-font-size_21 m-font-size_25_sm m-font-weight_300 m-line-height_normal m-margin-top_16 m-text-align_left m-padding-right_16">Warsaw</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.smartrecruiters.com/Allegro/743999947605953-mobile-software-engineer-android-allegro-pay?trid=de9dfdf3-7f9e-4ebf-8a64-49f6c69ad640">Sprawdź</a></article><article class="m-padding-top_16 m-padding-top_24_lg m-padding-right_16 m-padding-right_24_lg m-padding-bottom_16 m-padding-bottom_24_lg m-padding-left_16 m-padding-left_24_lg m-card m-margin-bottom_16 m-display-flex m-flex-justify_between m-flex-items-center m-flex-direction_column m-flex-direction_row_md m-color-bg_card"><h2 class="m-font-family_roboto m-margin-left_0 m-margin-right_0 m-margin-top_0 m-color_text m-font-weight_500 m-line-height_130 m-margin-bottom_8 m-margin-bottom_16_sm m-font-size_21 m-font-size_25_sm m-margin-bottom_0_sm m-flex-grow_1">Mobile Software Engineer (iOS)-Allegro Pay</h2><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-font-size_21 m-font-size_25_sm m-font-weight_300 m-line-height_normal m-margin-top_16 m-text-align_left m-padding-right_16">Warsaw</p><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://www.smartrecruiters.com/Allegro/743999947036804-mobile-software-engineer-ios-allegro-pay?trid=de9dfdf3-7f9e-4ebf-8a64-49f6c69ad640">Sprawdź</a></article></div><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-display_block m-margin-bottom_8 m-width_100 m-height_40 m-line-height_40 m-text-transform_uppercase m-letter-spacing_2 m-white-space_nowrap m-cursor_pointer m-overflow_hidden m-padding-left_16 m-padding-right_16 m-padding-top_0 m-padding-bottom_0 m-outline-style_dotted--focus m-outline-width_2 m-outline-color_teal m-outline-offset_n2 m-button m-box_border m-text-align_center m-display_inline-block m-color_secondary m-background-position_50p m-background-size_5000p m-transition-property_background-color m-transition-duration_fast m-button--secondary" href="https://allegro.pl/praca">Zobacz więcej ofert</a></div><footer class="m-color-bg_navy m-margin-top-32"><div class="m-width-max_1600 m-margin-left_auto m-margin-right_auto m-padding-top-24 m-padding-bottom-24 m-display-flex@sm m-flex-justify-between m-flex-items-center m-text-align_center"><p class="m-font-family_sans m-line-height_21 m-font-size_14 m-text-size-adjust_100p m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-color_text m-color_white m-padding-left-24@sm">Proudly built by Allegro Tech engineers</p><ul class="m-font-family_sans m-font-size_14 m-line-height_21 m-color_text m-text-size-adjust_100p m-list-style-type_none m-margin-top_0 m-margin-right_0 m-margin-bottom_0 m-margin-left_0 m-padding-top_0 m-padding-right_0 m-padding-bottom_0 m-padding-left_0 m-display-flex m-flex-justify-center"><li style="filter:brightness(0) invert(1);opacity:0.5" class="m-margin-right-8 m-margin-top-16 m-margin-top-0@sm m-color_white"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://github.com/allegro"><img src="https://assets.allegrostatic.com/metrum/icon/github-6a18df1729.svg" alt="Github" class="m-icon"/></a></li><li style="filter:brightness(0) invert(1);opacity:0.5" class="m-margin-right-8 m-margin-top-16 m-margin-top-0@sm m-color_white"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://www.facebook.com/allegro.tech/"><img src="https://assets.allegrostatic.com/metrum/icon/facebook-a2b92f9dcb.svg" alt="Facebook" class="m-icon"/></a></li><li style="filter:brightness(0) invert(1);opacity:0.5" class="m-margin-right-8 m-margin-top-16 m-margin-top-0@sm m-color_white"><a class="m-font-size_14 m-font-family_sans m-color_text m-text-decoration_none m-text-size-adjust_100p m-cursor_pointer m-link m-line-height_21" href="https://twitter.com/allegrotech"><img src="https://assets.allegrostatic.com/metrum/icon/twitter-25164a58aa.svg" alt="Twitter" class="m-icon"/></a></li></ul></div></footer><div style="visibility:hidden;height:0;overflow:hidden;position:relative"><img alt="doubleclick" width="1" height="1" style="position:absolute" src="https://pubads.g.doubleclick.net/activity;dc_iu=/21612525419/DFPAudiencePixel;ord=1867746761544.9683;dc_seg=507368552?"/><img alt="fb" height="1" width="1" style="position:absolute" src="https://www.facebook.com/tr?id=1650870088530325&amp;ev=PageView&amp;noscript=1"/></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"title":"How does B-tree make your queries fast?","link":"https://blog.allegro.tech/2023/11/how-does-btree-make-your-queries-fast.html","pubDate":"Mon, 27 Nov 2023 00:00:00 +0100","authors":{"author":[{"name":["Mateusz Kuźmik"],"photo":["https://blog.allegro.tech/img/authors/mateusz.kuzmik.jpg"],"url":["https://blog.allegro.tech/authors/mateusz.kuzmik"]}]},"content":"\u003cp\u003e\u003cstrong\u003eB-tree\u003c/strong\u003e is a structure that helps to search through great amounts of data.\nIt was invented over 40 years ago, yet it is still employed by the majority of modern databases.\nAlthough there are newer index structures, like LSM trees,\n\u003cstrong\u003eB-tree\u003c/strong\u003e is unbeaten when handling most of the database queries.\u003c/p\u003e\n\n\u003cp\u003eAfter reading this post, you will know how \u003cstrong\u003eB-tree\u003c/strong\u003e organises the data and how it performs search queries.\u003c/p\u003e\n\n\u003ch2 id=\"origins\"\u003eOrigins\u003c/h2\u003e\n\n\u003cp\u003eIn order to understand \u003cstrong\u003eB-tree\u003c/strong\u003e let’s focus on \u003cstrong\u003eBinary Search Tree (BST)\u003c/strong\u003e first.\u003c/p\u003e\n\n\u003cp\u003eWait, isn’t it the same?\u003c/p\u003e\n\n\u003cp\u003eWhat does “B” stand for then?\u003c/p\u003e\n\n\u003cp\u003eAccording to \u003ca href=\"https://en.wikipedia.org/wiki/B-tree\"\u003ewikipedia.org\u003c/a\u003e, Edward M. McCreight, the inventor of B-tree, once said:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e“the more you think about what the B in B-trees means, the better you understand B-trees.”\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eConfusing \u003cstrong\u003eB-tree\u003c/strong\u003e with \u003cstrong\u003eBST\u003c/strong\u003e is a really common misconception.\nAnyway, in my opinion, BST is a great starting point for reinventing B-tree.\nLet’s start with a simple example of BST:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/bst-basic.webp\" alt=\"Binary Search Tree with three nodes\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eThe greater number is always on the right, the lower on the left. It may become clearer when we add more numbers.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/bst-bigger.webp\" alt=\"Binary Search Tree with seven nodes\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eThis tree contains seven numbers, but we need to visit at most three nodes to locate any number.\nThe following example visualizes searching for 14.\nI used SQL to define the query in order to think about this tree as if it were an actual database index.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/bst-bigger-searching.webp\" alt=\"Searching for single node within Binary Search Tree with seven nodes\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003ch2 id=\"hardware\"\u003eHardware\u003c/h2\u003e\n\n\u003cp\u003eIn theory, using Binary Search Tree for running our queries looks fine. Its time complexity (when searching) is \\(O(log\nn)\\), \u003ca href=\"https://en.wikipedia.org/wiki/B-tree\"\u003esame as B-tree\u003c/a\u003e. However, in practice, this data structure needs to work on actual hardware. An index must be\nstored somewhere on your machine.\u003c/p\u003e\n\n\u003cp\u003eThe computer has three places where the data can be stored:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eCPU caches\u003c/li\u003e\n  \u003cli\u003eRAM (memory)\u003c/li\u003e\n  \u003cli\u003eDisk (storage)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe cache is managed fully by CPUs. Moreover, it is relatively small, usually a few megabytes.\nIndex may contain gigabytes of data, so it won’t fit there.\u003c/p\u003e\n\n\u003cp\u003eDatabases vastly use Memory (RAM). It has some great advantages:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eassures fast random access (more on that in the next paragraph)\u003c/li\u003e\n  \u003cli\u003eits size may be pretty big (e.g. AWS RDS cloud service \u003ca href=\"https://aws.amazon.com/rds/instance-types/\"\u003eprovides instances\u003c/a\u003e\nwith a few terabytes of memory available).\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eCons? You lose the data when the power supply goes off. Moreover, when compared to the disk, it is pretty expensive.\u003c/p\u003e\n\n\u003cp\u003eFinally, the cons of a memory are the pros of a disk storage.\nIt’s cheap, and data will remain there even if we lose the power.\nHowever, there are no free lunches!\nThe catch is that we need to be careful about random and sequential access.\nReading from the disk is fast, but only under certain conditions!\nI’ll try to explain them simply.\u003c/p\u003e\n\n\u003ch3 id=\"random-and-sequential-access\"\u003eRandom and sequential access\u003c/h3\u003e\n\n\u003cp\u003eMemory may be visualized as a line of containers for values, where every container is numbered.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/memory.webp\" alt=\"Simple memory visualization\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eNow let’s assume we want to read data from containers 1, 4, and 6. It requires random access:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/memory-random-access.webp\" alt=\"Random access visualized on a small chunk of a memory\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eAnd then let’s compare it with reading containers 3, 4, and 5. It may be done sequentially:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/memory-sequential-access.webp\" alt=\"Sequential access visualized on a small chunk of a memory\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eThe difference between a “random jump” and a “sequential read” can be explained based on Hard Disk Drive.\nIt consists of the head and the disk.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/hdd-disk.webp\" alt=\"Hard Disk Drive with cover removed, Public Domain image from https://en.wikipedia.org/wiki/Hard_disk_drive#/media/File:Laptop-hard-drive-exposed.jpg\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003e“Random jump” requires moving the head to the given place on the disk.\n“Sequential read” is simply spinning the disk, allowing the head to read consecutive values.\nWhen reading megabytes of data, the difference between these two types of access is enormous.\nUsing “sequential reads” lowers the time needed to fetch the data significantly.\u003c/p\u003e\n\n\u003cp\u003eDifferences in speed between random and sequential access were researched in the article “The Pathologies of Big Data”\nby Adam Jacobs, \u003ca href=\"https://queue.acm.org/detail.cfm?id=1563874\"\u003epublished in Acm Queue\u003c/a\u003e.\nIt revealed a few mind-blowing facts:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eSequential access on HDD may be hundreds of thousands of times faster than random access. 🤯\u003c/li\u003e\n  \u003cli\u003eIt may be faster to read sequentially from the disk than randomly from the memory.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWho even uses HDD nowadays?\nWhat about SSD?\nThis research shows that reading fully sequentially from HDD may be faster than SSD.\nHowever, please note that the article is from 2009 and SSD developed significantly through the last decade,\nthus these results are probably outdated.\u003c/p\u003e\n\n\u003cp\u003eTo sum up, the key takeaway is \u003cstrong\u003eto prefer sequential access wherever we can\u003c/strong\u003e.\nIn the next paragraph, I will explain how to apply it to our index structure.\u003c/p\u003e\n\n\u003ch2 id=\"optimizing-a-tree-for-sequential-access\"\u003eOptimizing a tree for sequential access\u003c/h2\u003e\n\n\u003cp\u003eBinary Search Tree may be represented in memory in the same way\nas \u003ca href=\"https://en.wikipedia.org/wiki/Binary_heap\"\u003ethe heap\u003c/a\u003e:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eparent node position is \\(i\\)\u003c/li\u003e\n  \u003cli\u003eleft node position is \\(2i\\)\u003c/li\u003e\n  \u003cli\u003eright node position is \\(2i+1\\)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThat’s how these positions are calculated based on the example (the parent node starts at 1):\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/tree-representation-in-memory-1.webp\" alt=\"Binary tree representation in the memory—part 1/2\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eAccording to the calculated positions, nodes are aligned into the memory:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/tree-representation-in-memory-2.webp\" alt=\"Binary tree representation in the memory—part 2/2\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eDo you remember the query visualized a few chapters ago?\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/bst-bigger-searching.webp\" alt=\"Searching for single node within Binary Search Tree with seven nodes\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eThat’s what it looks like on the memory level:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/tree-representation-in-memory-query.webp\" alt=\"Binary tree representation in the memory - querying\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen performing the query, memory addresses 1, 3, and 6 need to be visited.\nVisiting three nodes is not a problem; however, as we store more data, the tree gets higher.\nStoring more than one million values requires a tree of height at least 20. It means\nthat 20 values from different places in memory must be read.\nIt causes completely random access!\u003c/p\u003e\n\n\u003ch3 id=\"pages\"\u003ePages\u003c/h3\u003e\n\n\u003cp\u003eWhile a tree grows in height, random access is causing more and more delay.\nThe solution to reduce this problem is simple: grow the tree in width rather than in height.\nIt may be achieved by packing more than one value into a single node.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/tree-with-3-values-in-node.webp\" alt=\"A tree with three values in single node\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eIt brings us the following benefits:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003ethe tree is shallower (two levels instead of three)\u003c/li\u003e\n  \u003cli\u003eit still has a lot of space for new values without the need for growing further\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe query performed on such index looks as follows:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/tree-with-3-values-query.webp\" alt=\"A query performed on a tree with three values in a single node\" /\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease note that every time we visit a node, we need to load all its values.\nIn this example, we need to load 4 values (or 6 if the tree is full) in order to reach the one we are looking for.\nBelow, you will find a visualization of this tree in a memory:\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/tree-with-3-values-memory.webp\" alt=\"A tree with three values in a single node represented in a memory\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eCompared to \u003ca href=\"#optimizing-a-tree-for-sequential-access\"\u003ethe previous example\u003c/a\u003e (where the tree grows in height),\nthis search should be faster.\nWe need random access only twice (jump to cells 0 and 9) and then sequentially read the rest of values.\u003c/p\u003e\n\n\u003cp\u003eThis solution works better and better as our database grows. If you want to store one million values, then you need:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eBinary Search Tree which has \u003cstrong\u003e20\u003c/strong\u003e levels\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOR\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e3-value node Tree which has \u003cstrong\u003e10\u003c/strong\u003e levels\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eValues from a single node make a page.\nIn the example above, each page consists of three values.\nA page is a set of values placed on a disk next to each other,\nso the database may reach the whole page at once with one sequential read.\u003c/p\u003e\n\n\u003cp\u003eAnd how does it refer to the reality?\n\u003ca href=\"https://www.postgresql.org/docs/current/storage-toast.html#:~:text=PostgreSQL%20uses%20a%20fixed%20page,tuples%20to%20span%20multiple%20pages.\"\u003ePostgres page size is 8kB\u003c/a\u003e.\nLet’s assume that 20% is for metadata, so it’s 6kB left.\nHalf of the page is needed to store\npointers to node’s children, so it gives us 3kB for values.\nBIGINT size is 8 bytes, thus we may store ~375 values in a\nsingle page.\u003c/p\u003e\n\n\u003cp\u003eAssuming that some pretty big tables in a database have one billion rows,\nhow many levels in the Postgres tree do we need to store them?\nAccording to the calculations above,\nif we create a tree that can handle 375 values in a single node,\nit may store \u003cstrong\u003e1 billion\u003c/strong\u003e values with a tree that has only \u003cstrong\u003efour\u003c/strong\u003e levels.\nBinary Search Tree would require 30 levels for such amount of data.\u003c/p\u003e\n\n\u003cp\u003eTo sum up, placing multiple values in a single node of the tree helped us to reduce its height, thus using the benefits of sequential access.\nMoreover, a B-tree may grow not only in height, but also in width (by using larger pages).\u003c/p\u003e\n\n\u003ch2 id=\"balancing\"\u003eBalancing\u003c/h2\u003e\n\n\u003cp\u003eThere are two types of operations in databases: writing and reading.\nIn the previous section, we addressed the problems with reading the data from the B-tree.\nNonetheless, writing is also a crucial part.\nWhen writing the data to a database, B-tree needs to be constantly updated with new values.\u003c/p\u003e\n\n\u003cp\u003eThe tree shape depends on the order of values added to the tree.\nIt’s easily visible in a binary tree.\nWe may obtain trees with different depths if the values are added in an incorrect order.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/bst-imbalance.webp\" alt=\"Two Binary Trees with shapes depending on the order of inserted values.\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen the tree has different depths on different nodes, it is called an unbalanced tree.\nThere are basically two ways of returning such a tree to a balanced state:\u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003eRebuilding it from the very beginning just by adding the values in the correct order.\u003c/li\u003e\n  \u003cli\u003eKeeping it balanced all the time, as the new values are added.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eB-tree implements the second option. A feature that makes the tree balanced all the time is called self-balancing.\u003c/p\u003e\n\n\u003ch3 id=\"self-balancing-algorithm-by-example\"\u003eSelf-balancing algorithm by example\u003c/h3\u003e\n\n\u003cp\u003eBuilding a B-tree can be started simply by creating a single node\nand adding new values until there is no free space in it.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/self-balancing-step-1.webp\" alt=\"Self-balancing, step 1, Add new values until there is a free space in existing nodes.\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eIf there is no space on the corresponding page, it needs to be split.\nTo perform a split, a „split point” is chosen.\nIn that case, it will be 12, because it is in the middle.\nThe „Split point” is a value that will be moved to the upper page.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/self-balancing-step-2a.webp\" alt=\"Self-balancing, step 2a, Splitting the page.\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eNow, it gets us to an interesting point where there is no upper page.\nIn such a case, a new one needs to be generated (and it becomes the new root page!).\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/self-balancing-step-2b.webp\" alt=\"Self-balancing, step 2b, Generating a new root page.\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eAnd finally, there is some free space in the three, so value 14 may be added.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/self-balancing-step-2c.webp\" alt=\"Self-balancing, step 2c, Adding the 14 to B-tree.\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eFollowing this algorithm, we may constantly add new values to the B-tree, and it will remain balanced all the time!\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-11-27-how-does-btree-make-your-queries-fast/self-balancing-step-final.webp\" alt=\"Self-balancing, Final state of the B-tree, after adding multiple values.\" /\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eAt this point, you may have a valid concern that there is a lot of free space that has no chance to be\nfilled.\nFor example, values 14, 15, and 16, are on different pages, so these pages will remain with only one value and two free spaces forever.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eIt was caused by the split location choice.\nWe always split the page in the middle.\nBut every time we do a split, we may choose any split location we want.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003ePostgres has an algorithm that is run every time a split is performed!\nIts implementation may be found in the \u003ca href=\"https://github.com/postgres/postgres/blob/54ccfd65868c013a8c6906bc894bc5ea3640740a/src/backend/access/nbtree/nbtsplitloc.c#L87\"\u003e_bt_findsplitloc() function in Postgres source code\u003c/a\u003e.\nIts goal is to leave as little free space as possible.\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eIn this article, you learned how a B-tree works.\nAll in all, it may be simply described as a Binary Search Tree with two changes:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eevery node may contain more than one value\u003c/li\u003e\n  \u003cli\u003einserting a new value is followed by a self-balancing algorithm.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAlthough the structures used by modern databases are usually some variants of a B-tree (like B+tree), they are still based on the original conception.\nIn my opinion, one great strength of a B-tree is the fact that it was designed directly to handle large amounts of data on actual hardware.\nIt may be the reason why the B-tree has remained with us for such a long time.\u003c/p\u003e\n","contentSnippet":"B-tree is a structure that helps to search through great amounts of data.\nIt was invented over 40 years ago, yet it is still employed by the majority of modern databases.\nAlthough there are newer index structures, like LSM trees,\nB-tree is unbeaten when handling most of the database queries.\nAfter reading this post, you will know how B-tree organises the data and how it performs search queries.\nOrigins\nIn order to understand B-tree let’s focus on Binary Search Tree (BST) first.\nWait, isn’t it the same?\nWhat does “B” stand for then?\nAccording to wikipedia.org, Edward M. McCreight, the inventor of B-tree, once said:\n“the more you think about what the B in B-trees means, the better you understand B-trees.”\nConfusing B-tree with BST is a really common misconception.\nAnyway, in my opinion, BST is a great starting point for reinventing B-tree.\nLet’s start with a simple example of BST:\n\nThe greater number is always on the right, the lower on the left. It may become clearer when we add more numbers.\n\nThis tree contains seven numbers, but we need to visit at most three nodes to locate any number.\nThe following example visualizes searching for 14.\nI used SQL to define the query in order to think about this tree as if it were an actual database index.\n\nHardware\nIn theory, using Binary Search Tree for running our queries looks fine. Its time complexity (when searching) is \\(O(log\nn)\\), same as B-tree. However, in practice, this data structure needs to work on actual hardware. An index must be\nstored somewhere on your machine.\nThe computer has three places where the data can be stored:\nCPU caches\nRAM (memory)\nDisk (storage)\nThe cache is managed fully by CPUs. Moreover, it is relatively small, usually a few megabytes.\nIndex may contain gigabytes of data, so it won’t fit there.\nDatabases vastly use Memory (RAM). It has some great advantages:\nassures fast random access (more on that in the next paragraph)\nits size may be pretty big (e.g. AWS RDS cloud service provides instances\nwith a few terabytes of memory available).\nCons? You lose the data when the power supply goes off. Moreover, when compared to the disk, it is pretty expensive.\nFinally, the cons of a memory are the pros of a disk storage.\nIt’s cheap, and data will remain there even if we lose the power.\nHowever, there are no free lunches!\nThe catch is that we need to be careful about random and sequential access.\nReading from the disk is fast, but only under certain conditions!\nI’ll try to explain them simply.\nRandom and sequential access\nMemory may be visualized as a line of containers for values, where every container is numbered.\n\nNow let’s assume we want to read data from containers 1, 4, and 6. It requires random access:\n\nAnd then let’s compare it with reading containers 3, 4, and 5. It may be done sequentially:\n\nThe difference between a “random jump” and a “sequential read” can be explained based on Hard Disk Drive.\nIt consists of the head and the disk.\n\n“Random jump” requires moving the head to the given place on the disk.\n“Sequential read” is simply spinning the disk, allowing the head to read consecutive values.\nWhen reading megabytes of data, the difference between these two types of access is enormous.\nUsing “sequential reads” lowers the time needed to fetch the data significantly.\nDifferences in speed between random and sequential access were researched in the article “The Pathologies of Big Data”\nby Adam Jacobs, published in Acm Queue.\nIt revealed a few mind-blowing facts:\nSequential access on HDD may be hundreds of thousands of times faster than random access. 🤯\nIt may be faster to read sequentially from the disk than randomly from the memory.\nWho even uses HDD nowadays?\nWhat about SSD?\nThis research shows that reading fully sequentially from HDD may be faster than SSD.\nHowever, please note that the article is from 2009 and SSD developed significantly through the last decade,\nthus these results are probably outdated.\nTo sum up, the key takeaway is to prefer sequential access wherever we can.\nIn the next paragraph, I will explain how to apply it to our index structure.\nOptimizing a tree for sequential access\nBinary Search Tree may be represented in memory in the same way\nas the heap:\nparent node position is \\(i\\)\nleft node position is \\(2i\\)\nright node position is \\(2i+1\\)\nThat’s how these positions are calculated based on the example (the parent node starts at 1):\n\nAccording to the calculated positions, nodes are aligned into the memory:\n\nDo you remember the query visualized a few chapters ago?\n\nThat’s what it looks like on the memory level:\n\nWhen performing the query, memory addresses 1, 3, and 6 need to be visited.\nVisiting three nodes is not a problem; however, as we store more data, the tree gets higher.\nStoring more than one million values requires a tree of height at least 20. It means\nthat 20 values from different places in memory must be read.\nIt causes completely random access!\nPages\nWhile a tree grows in height, random access is causing more and more delay.\nThe solution to reduce this problem is simple: grow the tree in width rather than in height.\nIt may be achieved by packing more than one value into a single node.\n\nIt brings us the following benefits:\nthe tree is shallower (two levels instead of three)\nit still has a lot of space for new values without the need for growing further\nThe query performed on such index looks as follows:\n\nPlease note that every time we visit a node, we need to load all its values.\nIn this example, we need to load 4 values (or 6 if the tree is full) in order to reach the one we are looking for.\nBelow, you will find a visualization of this tree in a memory:\n\nCompared to the previous example (where the tree grows in height),\nthis search should be faster.\nWe need random access only twice (jump to cells 0 and 9) and then sequentially read the rest of values.\nThis solution works better and better as our database grows. If you want to store one million values, then you need:\nBinary Search Tree which has 20 levels\nOR\n3-value node Tree which has 10 levels\nValues from a single node make a page.\nIn the example above, each page consists of three values.\nA page is a set of values placed on a disk next to each other,\nso the database may reach the whole page at once with one sequential read.\nAnd how does it refer to the reality?\nPostgres page size is 8kB.\nLet’s assume that 20% is for metadata, so it’s 6kB left.\nHalf of the page is needed to store\npointers to node’s children, so it gives us 3kB for values.\nBIGINT size is 8 bytes, thus we may store ~375 values in a\nsingle page.\nAssuming that some pretty big tables in a database have one billion rows,\nhow many levels in the Postgres tree do we need to store them?\nAccording to the calculations above,\nif we create a tree that can handle 375 values in a single node,\nit may store 1 billion values with a tree that has only four levels.\nBinary Search Tree would require 30 levels for such amount of data.\nTo sum up, placing multiple values in a single node of the tree helped us to reduce its height, thus using the benefits of sequential access.\nMoreover, a B-tree may grow not only in height, but also in width (by using larger pages).\nBalancing\nThere are two types of operations in databases: writing and reading.\nIn the previous section, we addressed the problems with reading the data from the B-tree.\nNonetheless, writing is also a crucial part.\nWhen writing the data to a database, B-tree needs to be constantly updated with new values.\nThe tree shape depends on the order of values added to the tree.\nIt’s easily visible in a binary tree.\nWe may obtain trees with different depths if the values are added in an incorrect order.\n\nWhen the tree has different depths on different nodes, it is called an unbalanced tree.\nThere are basically two ways of returning such a tree to a balanced state:\nRebuilding it from the very beginning just by adding the values in the correct order.\nKeeping it balanced all the time, as the new values are added.\nB-tree implements the second option. A feature that makes the tree balanced all the time is called self-balancing.\nSelf-balancing algorithm by example\nBuilding a B-tree can be started simply by creating a single node\nand adding new values until there is no free space in it.\n\nIf there is no space on the corresponding page, it needs to be split.\nTo perform a split, a „split point” is chosen.\nIn that case, it will be 12, because it is in the middle.\nThe „Split point” is a value that will be moved to the upper page.\n\nNow, it gets us to an interesting point where there is no upper page.\nIn such a case, a new one needs to be generated (and it becomes the new root page!).\n\nAnd finally, there is some free space in the three, so value 14 may be added.\n\nFollowing this algorithm, we may constantly add new values to the B-tree, and it will remain balanced all the time!\n\nAt this point, you may have a valid concern that there is a lot of free space that has no chance to be\nfilled.\nFor example, values 14, 15, and 16, are on different pages, so these pages will remain with only one value and two free spaces forever.\nIt was caused by the split location choice.\nWe always split the page in the middle.\nBut every time we do a split, we may choose any split location we want.\nPostgres has an algorithm that is run every time a split is performed!\nIts implementation may be found in the _bt_findsplitloc() function in Postgres source code.\nIts goal is to leave as little free space as possible.\nSummary\nIn this article, you learned how a B-tree works.\nAll in all, it may be simply described as a Binary Search Tree with two changes:\nevery node may contain more than one value\ninserting a new value is followed by a self-balancing algorithm.\nAlthough the structures used by modern databases are usually some variants of a B-tree (like B+tree), they are still based on the original conception.\nIn my opinion, one great strength of a B-tree is the fact that it was designed directly to handle large amounts of data on actual hardware.\nIt may be the reason why the B-tree has remained with us for such a long time.","guid":"https://blog.allegro.tech/2023/11/how-does-btree-make-your-queries-fast.html","categories":["tech"],"isoDate":"2023-11-26T23:00:00.000Z","thumbnail":"images/post-headers/default.jpg"},{"title":"Beyond the Code - An Engineer’s Battle Against Knowledge Loss","link":"https://blog.allegro.tech/2023/10/battle-against-knowledge-loss.html","pubDate":"Mon, 30 Oct 2023 00:00:00 +0100","authors":{"author":[{"name":["Krzysztof Przychodzki"],"photo":["https://blog.allegro.tech/img/authors/krzysztof.przychodzki.jpg"],"url":["https://blog.allegro.tech/authors/krzysztof.przychodzki"]}]},"content":"\u003cp\u003eThe idea for this article arose during a meeting where we learned that our supervisor would be leaving the company to pursue new opportunities. In response, a\ncolleague lamented that what we would miss most is the knowledge departing with the leader. Unfortunately, that’s how it goes. Not only do we lose a colleague,\nbut we also lose valuable knowledge and experience. However, this isn’t a story about my supervisor; it’s a story about all those individuals who are experts in\ntheir fields, who understand the paths to success and paths that lead to catastrophic failures. When they leave, they take with them knowledge that you won’t\nfind in any book, note, or Jira ticket. And this leads to a fundamental question: \u003cem\u003eWhat can be done to avoid this “black hole” of knowledge? How can we ensure\nit doesn’t vanish along with them?\u003c/em\u003e That’s what this article is all about.\u003c/p\u003e\n\n\u003ch2 id=\"business-decisions-somebody-made-and-didnt-tell-you\"\u003eBusiness Decisions Somebody Made… and didn’t tell you\u003c/h2\u003e\n\n\u003cp\u003eSpecifically for this article I created the term \u003cem\u003eBiological Data Storage\u003c/em\u003e or \u003cem\u003eBDS\u003c/em\u003e for short. This term encompasses nearly every employee in a company. I\nunderstand that nobody wants to be seen as just a resource, and certainly not as part of the \u003cem\u003eBiological Data Storage\u003c/em\u003e. However, in the context of a company’s\nresources, an employee can be likened to a technical data repository, but with the valuable addition of context.\u003c/p\u003e\n\n\u003cp\u003eI wanted to examine this issue more broadly from an engineer’s perspective. We often hear about Conway’s Law:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003eAny organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization’s communication structure. \u003csup id=\"fnref:1\" role=\"doc-noteref\"\u003e\u003ca href=\"#fn:1\" class=\"footnote\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAnd I perceive the loss of knowledge as a depletion of communication, which can ultimately result in its imperfections within the created system.\u003c/p\u003e\n\n\u003cp\u003eThe engineering approach is marked by our commitment to gauging the impact of various events and assessing their real significance using specific metrics. When\ndealing with the challenge of an employee departing, consider these metrics to evaluate organizational effectiveness:\u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003eTime to Problem Resolution:\n    \u003cul\u003e\n      \u003cli\u003emeasures how quickly issues or challenges are resolved and helps identify the efficiency of problem-solving processes.\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003eKnowledge Transfer Rate:\n    \u003cul\u003e\n      \u003cli\u003emeasures how long it takes for a new employee to become self-sufficient and also indicates the effectiveness of knowledge transfer and onboarding.\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI think these metrics provide valuable insights into organizational efficiency and its capacity to seamlessly integrate new team members.\nIn the context of Conway’s Law, the loss of knowledge becomes a critical factor influencing not only communication but also the very design of systems within\nthe company.\u003c/p\u003e\n\n\u003cp\u003eConsider this: when a team member with a wealth of knowledge and expertise departs, they take with them not just facts and figures but also their unique\ninsights, problem-solving approaches, and understanding of the organization’s intricacies. The lack of such knowledge can disrupt the flow of information within\nteams and across departments. As a result, the communication structure can falter, hindering the organization’s ability to respond to challenges effectively.\u003c/p\u003e\n\n\u003cp\u003eMoreover, the design of systems can be profoundly impacted. Engineers and developers who were privy to invaluable knowledge may have made design choices based\non their expertise. These decisions may not have been documented or clearly understood by others, and when their authors leave, may become opaque. This can lead\nto difficulties in maintaining and developing these systems, potentially causing inefficiencies and vulnerabilities.\u003c/p\u003e\n\n\u003cp\u003eNow, when we introduce the \u003cem\u003eKnowledge Transfer Rate\u003c/em\u003e metric into this context, it becomes evident that measuring how long it takes for a new employee to become\nself-sufficient is crucial. The longer this duration, the more pronounced the knowledge gap becomes, affecting both communication and system design.\nOrganizations must recognize that knowledge isn’t just about data; it’s about understanding and context, and its loss can significantly impede the smooth\nfunctioning of teams and the evolution of systems.\u003c/p\u003e\n\n\u003ch2 id=\"organizations-have-no-memory\"\u003eOrganizations have no memory\u003c/h2\u003e\n\n\u003cp\u003eYou might ask, “What’s the impact of losing this knowledge on a company?” Is it that business processes start collapsing like houses of cards? Innovation loses\nits wings? The company’s efficiency plummets like leaves in an autumn storm?\nThe answer to the above questions in 98% of cases is - of course, no - because we can manage such risks. Companies have ways of dealing with them, but do they,\nreally?\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eOrganizations have no memory\u003c/em\u003e is a quote from Trevor Kletz’s book \u003cem\u003eLessons from Disaster\u003c/em\u003e, which highlights the concept of organizational memory and how\nincidents and accidents can recur due to the lack of effective learning from past mistakes within an organization. Prof. Kletz highlights the organization’s\ninability to learn from accidents, even those occurring within the company. I sometimes feel that a similar pattern emerges when knowledge departs from our\ncompany. Perhaps because it can’t be easily measured in money, it’s often downplayed.\u003c/p\u003e\n\n\u003cp\u003eWhile Kletz’s book pertains to chemical engineering, I see several universal truths that apply to any situation and industry. For example, another quote, “What\nyou don’t have, can’t leak” is remarkably similar to the idea that code you don’t have is \u003cem\u003emaintainless\u003c/em\u003e and won’t have bugs. There are likely analogous\nprinciples in our field.\u003c/p\u003e\n\n\u003cp\u003eHowever, even at this stage, the process of knowledge acquisition can be accelerated. There are several ways to do it, such as creating procedures, diagrams,\ncharts, and documentation.\u003c/p\u003e\n\n\u003cp\u003eDocumentation is like treasure maps in the business world. Creating documentation is one thing, but keeping it up-to-date within an organization (regardless of\nits size) is a challenge. Encouraging the team to regularly update documentation is also a challenge. Even the best-prepared documentation often lacks many\ndetails, like the rationale behind specific business decisions, why a particular database or framework was chosen, or why we use technology \u003cem\u003eY\u003c/em\u003e instead of the\nmore prevalent \u003cem\u003eX\u003c/em\u003e throughout the company.\u003c/p\u003e\n\n\u003cp\u003eSo, while documentation is like treasure maps for your company, recorded, organized, and structured information about processes, systems, and practices within\nthe company are akin to Architecture Decision Records (ADRs). ADRs are like the flight recorders of our business. They contain records of critical decisions\nmade during system design or significant technological choices.\u003c/p\u003e\n\n\u003cp\u003eWhy is this important? When creating new things, we make numerous decisions that may appear irrational without the right context later on. ADRs are like opening\na box that explains why these decisions were made. It’s the key to understanding the company’s history and evolution. In the context of our \u003cem\u003eBDS\u003c/em\u003e, ADRs are\nlike recordings of experts’ thoughts when making key decisions. When these experts leave, these recordings become a treasure trove of knowledge, helping us\navoid repeating the same mistakes.\u003c/p\u003e\n\n\u003cp\u003eA common scenario emerges: the team tasked with addressing the problem must invest valuable time in rediscovering solutions, experimenting with potential fixes,\nor even resorting to trial and error. This not only prolongs the problem-solving process but can also result in suboptimal resolutions, increased frustration,\nand a negative impact on overall productivity. Thanks to documentation and ADR we can significantly reduce this time.\u003c/p\u003e\n\n\u003ch2 id=\"an-alternative-to-lengthy-documentation\"\u003eAn alternative to lengthy documentation?\u003c/h2\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003eNo one reads.\nIf someone does read, he doesn’t understand.\nIf he understands, he immediately forgets.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eUnfortunately, just as is the case in the above quote from Stanisław Lem \u003csup id=\"fnref:2\" role=\"doc-noteref\"\u003e\u003ca href=\"#fn:2\" class=\"footnote\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003e, the problem with documentation, procedures, and ADRs is that people need to\nfamiliarize themselves with them. I suppose that even at SpaceX, it’s doubtful this would be considered the most thrilling reading material, or maybe I am just\nmistaken. Anyway, even if someone manages to get through the documentation, they’ll only retain what they understand. We’re presented with the work of others,\nwith their imposed ways of thinking and decision-making. Often, questions arise to which no one knows the answers, and the people who do know are no longer with\nthe company.\u003c/p\u003e\n\n\u003cp\u003eSince we now know our mental limitations, instead of forcing people to sift through stacks of documentation, we can\nuse \u003ca href=\"https://blog.allegro.tech/2022/07/event-storming-workshops.html\"\u003eEventStorming\u003c/a\u003e. This technique helps understand business processes, identify events and\nactivities, and integrate knowledge in an understandable way. We focus on behaviors, on what changes and why. Together, we develop a solution and understand the\nprocesses because we see them from start to finish. Understanding a process through EventStorming is faster and easier than reading documentation. During an\nEventStorming session, most questions find answers, and knowledge can be conveyed to many people simultaneously, whether they are technical or not. The most\nsignificant artifact of such sessions is that you can discuss why the process looks the way it does, why a specific sequence was chosen, and not another —\nessentially, a mega-mix of documentation, ADR, and conversation. I emphasize once more that this understanding of the process is developed collectively —\neveryone feels as a part of the solution. In the case of our \u003cem\u003eBDS\u003c/em\u003e, EventStorming is like capturing the thoughts of experts when making crucial decisions.\u003c/p\u003e\n\n\u003ch3 id=\"real-life-example\"\u003eReal life example\u003c/h3\u003e\n\n\u003cp\u003eAt \u003ca href=\"https://allegro.tech/\"\u003eAllegro\u003c/a\u003e, we recently had a situation where the entire development team responsible for a critical service was moved to a different\nproject. The new team, which inherited the service, had the opportunity to collaborate with the departing team for a period. However, in this context, we also\nconducted EventStorming sessions. To provide more detail, these sessions extended over two full days, each lasting 8 hours. The knowledge accumulated over the\npast five years was not merely confined to two plotter paper-sized sheets, each stretching 6 meters in length, but was primarily assimilated within the\nparticipants’ minds in a seamless manner. I believe this facilitated the new team in gaining greater confidence when taking over the domain.\u003c/p\u003e\n\n\u003cp\u003eInterestingly, you don’t need to spend a lot of time on EventStorming to uncover enough business knowledge. In the case mentioned earlier, the session lasted\ntwo days, but it involved an entire team. For an individual, a two-hour workshop can be enough to see the big picture of our process. Although EventStorming\nallows us to absorb a dose of knowledge relatively easily to know \u003cem\u003ewhat and why\u003c/em\u003e is changing in our process, the devil is in the detail. To really understand\n\u003cem\u003ehow\u003c/em\u003e this process is changing, it’s best to start by doing small tasks under the guidance of an experienced person.\u003c/p\u003e\n\n\u003ch2 id=\"seeking-uml-like-alternatives\"\u003eSeeking UML-like Alternatives?\u003c/h2\u003e\n\n\u003cp\u003eUnfortunately, EventStorming is not the answer to all knowledge loss-related problems. While I don’t question how fantastic this tool is, the knowledge acquired\nthrough it will remain only in the participants’ minds. If it’s not somehow preserved in the form of documentation or ADRs, it may turn out to be just as\nfleeting as departing employees. What can be done about this? Our initial thoughts may lead us to create some form of description or documentation, which, as we\nknow, comes with the challenge of its preparation and the cognitive overload for someone trying to assimilate new knowledge.\u003c/p\u003e\n\n\u003cp\u003eIt seems that when dealing with the issue of knowledge loss and its effective transfer, it’s worth mentioning tools like BPMN, which stands for Business Process\nModel and Notation. BPMN provides a standardized graphical representation of business processes. By using BPMN diagrams, we can visually map\nworkflows and procedures. Such an approach not only simplifies the understanding of complex processes but also aids in comprehensive documentation. When\ncombined with other knowledge-sharing techniques, such as EventStorming, BPMN can be a powerful asset in preserving and transferring critical business\nknowledge.\u003c/p\u003e\n\n\u003cp\u003eHowever, BPMN has an elaborate set of symbols and notation rules, which can make creating and interpreting diagrams complicated for some individuals. Creating\nadvanced BPMN diagrams and fully utilizing the notation’s potential requires specialized knowledge and experience. People unfamiliar with BPMN may struggle\nto use it effectively. Despite these inconveniences, BPMN still remains a valuable tool for modeling and documenting business processes in many organizations. I\nbelieve it complements the previously mentioned techniques perfectly.\u003c/p\u003e\n\n\u003cp\u003eJust remember to have the right tools in your arsenal and, more importantly, to choose the appropriate tool for the situation, considering both its strengths\nand weaknesses.\u003c/p\u003e\n\n\u003ch2 id=\"one-more-thing\"\u003eOne more thing…\u003c/h2\u003e\n\n\u003cp\u003e\u003cem\u003eTime to Problem Resolution\u003c/em\u003e metric serves as a clear indicator of an organization’s efficiency in addressing challenges. A shorter time to resolution signifies\nthat issues are tackled swiftly, minimizing disruptions and ensuring that the organization operates smoothly.\n\u003cem\u003eKnowledge Transfer Rate\u003c/em\u003e metric is a means to quantify and address the loss of knowledge, shedding light on its impact on communication structures and system\ndesign within an organization.\u003c/p\u003e\n\n\u003cp\u003eBoth metrics are directly influenced by the use of appropriate tools such as documentation, ADRs, EventStorming or BPMN. I have tried to highlight their\nadvantages and disadvantages in the context of knowledge transfer.\u003c/p\u003e\n\n\u003cp\u003eHowever, there is another challenge - changing the company’s culture. Employees must know what tools they have and feel that sharing knowledge is key to\nsuccess. Leadership plays a crucial role here, as leaders need to actively promote and engage in knowledge sharing and open communication. If company leaders\nactively endorse and engage in knowledge sharing, other employees are more likely to follow suit. However, changing organizational culture is a time-consuming\nprocess. Patience and perseverance are essential until new behaviors and beliefs prevail over old ones.\u003c/p\u003e\n\n\u003ch2 id=\"this-can-be-done\"\u003eThis can be done\u003c/h2\u003e\n\n\u003cp\u003eAs an engineer in an organisation, regardless of size, there are several proactive steps you can take to facilitate knowledge transfer. First and foremost,\nactively engage in open communication with your colleagues. Encourage discussion and information sharing, especially within your area of expertise, to ensure\nthat valuable insights are shared. Second, mentorship can be a powerful tool. Offer to mentor junior team members or be open to seeking guidance from more\nexperienced colleagues. In addition, participate in knowledge-sharing initiatives within the company, such as brown bag sessions, workshops or cross-functional\nprojects. Finally, consider creating or contributing to internal documentation and repositories. These resources can serve as valuable references for your\ncolleagues and future team members, ensuring that knowledge is retained within the organisation. By actively participating in these practices, you can play a\nkey role in preserving and transferring critical knowledge within your organisation.\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eIn this article, I aimed to discuss how knowledge loss in a company appears through an engineer’s eyes and why it can pose a threat. The term \u003cem\u003eBiological Data\nStorage\u003c/em\u003e may sound unconventional, but it emphasises the critical role that every team member plays in preserving and transferring knowledge. It’s important to\nremember that employees are not just resources; they are the living repositories of valuable information, experience and expertise. In the world of \u003cem\u003eBDS\u003c/em\u003e, every\nmember contributes to the collective body of knowledge, shaping the organisation’s communication structure.\nAs we say goodbye to departing colleagues, let’s also say goodbye to the notion that knowledge should be confined to individual minds. Instead, let’s adopt a\nculture of open communication, active knowledge sharing and the right tools, such as EventStorming and BPMN, to capture, preserve and share critical knowledge\nacross our organisation.\u003c/p\u003e\n\n\u003ch3 id=\"footnotes\"\u003eFootnotes\u003c/h3\u003e\n\n\u003cdiv class=\"footnotes\" role=\"doc-endnotes\"\u003e\n  \u003col\u003e\n    \u003cli id=\"fn:1\" role=\"doc-endnote\"\u003e\n      \u003cp\u003eQuote from https://en.wikipedia.org/wiki/Conway%27s_law \u003ca href=\"#fnref:1\" class=\"reversefootnote\" role=\"doc-backlink\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\n    \u003c/li\u003e\n    \u003cli id=\"fn:2\" role=\"doc-endnote\"\u003e\n      \u003cp\u003ehttps://en.wikipedia.org/wiki/Stanis%C5%82aw_Lem \u003ca href=\"#fnref:2\" class=\"reversefootnote\" role=\"doc-backlink\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\n    \u003c/li\u003e\n  \u003c/ol\u003e\n\u003c/div\u003e\n","contentSnippet":"The idea for this article arose during a meeting where we learned that our supervisor would be leaving the company to pursue new opportunities. In response, a\ncolleague lamented that what we would miss most is the knowledge departing with the leader. Unfortunately, that’s how it goes. Not only do we lose a colleague,\nbut we also lose valuable knowledge and experience. However, this isn’t a story about my supervisor; it’s a story about all those individuals who are experts in\ntheir fields, who understand the paths to success and paths that lead to catastrophic failures. When they leave, they take with them knowledge that you won’t\nfind in any book, note, or Jira ticket. And this leads to a fundamental question: What can be done to avoid this “black hole” of knowledge? How can we ensure\nit doesn’t vanish along with them? That’s what this article is all about.\nBusiness Decisions Somebody Made… and didn’t tell you\nSpecifically for this article I created the term Biological Data Storage or BDS for short. This term encompasses nearly every employee in a company. I\nunderstand that nobody wants to be seen as just a resource, and certainly not as part of the Biological Data Storage. However, in the context of a company’s\nresources, an employee can be likened to a technical data repository, but with the valuable addition of context.\nI wanted to examine this issue more broadly from an engineer’s perspective. We often hear about Conway’s Law:\nAny organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization’s communication structure. 1\nAnd I perceive the loss of knowledge as a depletion of communication, which can ultimately result in its imperfections within the created system.\nThe engineering approach is marked by our commitment to gauging the impact of various events and assessing their real significance using specific metrics. When\ndealing with the challenge of an employee departing, consider these metrics to evaluate organizational effectiveness:\nTime to Problem Resolution:\n    \nmeasures how quickly issues or challenges are resolved and helps identify the efficiency of problem-solving processes.\nKnowledge Transfer Rate:\n    \nmeasures how long it takes for a new employee to become self-sufficient and also indicates the effectiveness of knowledge transfer and onboarding.\nI think these metrics provide valuable insights into organizational efficiency and its capacity to seamlessly integrate new team members.\nIn the context of Conway’s Law, the loss of knowledge becomes a critical factor influencing not only communication but also the very design of systems within\nthe company.\nConsider this: when a team member with a wealth of knowledge and expertise departs, they take with them not just facts and figures but also their unique\ninsights, problem-solving approaches, and understanding of the organization’s intricacies. The lack of such knowledge can disrupt the flow of information within\nteams and across departments. As a result, the communication structure can falter, hindering the organization’s ability to respond to challenges effectively.\nMoreover, the design of systems can be profoundly impacted. Engineers and developers who were privy to invaluable knowledge may have made design choices based\non their expertise. These decisions may not have been documented or clearly understood by others, and when their authors leave, may become opaque. This can lead\nto difficulties in maintaining and developing these systems, potentially causing inefficiencies and vulnerabilities.\nNow, when we introduce the Knowledge Transfer Rate metric into this context, it becomes evident that measuring how long it takes for a new employee to become\nself-sufficient is crucial. The longer this duration, the more pronounced the knowledge gap becomes, affecting both communication and system design.\nOrganizations must recognize that knowledge isn’t just about data; it’s about understanding and context, and its loss can significantly impede the smooth\nfunctioning of teams and the evolution of systems.\nOrganizations have no memory\nYou might ask, “What’s the impact of losing this knowledge on a company?” Is it that business processes start collapsing like houses of cards? Innovation loses\nits wings? The company’s efficiency plummets like leaves in an autumn storm?\nThe answer to the above questions in 98% of cases is - of course, no - because we can manage such risks. Companies have ways of dealing with them, but do they,\nreally?\nOrganizations have no memory is a quote from Trevor Kletz’s book Lessons from Disaster, which highlights the concept of organizational memory and how\nincidents and accidents can recur due to the lack of effective learning from past mistakes within an organization. Prof. Kletz highlights the organization’s\ninability to learn from accidents, even those occurring within the company. I sometimes feel that a similar pattern emerges when knowledge departs from our\ncompany. Perhaps because it can’t be easily measured in money, it’s often downplayed.\nWhile Kletz’s book pertains to chemical engineering, I see several universal truths that apply to any situation and industry. For example, another quote, “What\nyou don’t have, can’t leak” is remarkably similar to the idea that code you don’t have is maintainless and won’t have bugs. There are likely analogous\nprinciples in our field.\nHowever, even at this stage, the process of knowledge acquisition can be accelerated. There are several ways to do it, such as creating procedures, diagrams,\ncharts, and documentation.\nDocumentation is like treasure maps in the business world. Creating documentation is one thing, but keeping it up-to-date within an organization (regardless of\nits size) is a challenge. Encouraging the team to regularly update documentation is also a challenge. Even the best-prepared documentation often lacks many\ndetails, like the rationale behind specific business decisions, why a particular database or framework was chosen, or why we use technology Y instead of the\nmore prevalent X throughout the company.\nSo, while documentation is like treasure maps for your company, recorded, organized, and structured information about processes, systems, and practices within\nthe company are akin to Architecture Decision Records (ADRs). ADRs are like the flight recorders of our business. They contain records of critical decisions\nmade during system design or significant technological choices.\nWhy is this important? When creating new things, we make numerous decisions that may appear irrational without the right context later on. ADRs are like opening\na box that explains why these decisions were made. It’s the key to understanding the company’s history and evolution. In the context of our BDS, ADRs are\nlike recordings of experts’ thoughts when making key decisions. When these experts leave, these recordings become a treasure trove of knowledge, helping us\navoid repeating the same mistakes.\nA common scenario emerges: the team tasked with addressing the problem must invest valuable time in rediscovering solutions, experimenting with potential fixes,\nor even resorting to trial and error. This not only prolongs the problem-solving process but can also result in suboptimal resolutions, increased frustration,\nand a negative impact on overall productivity. Thanks to documentation and ADR we can significantly reduce this time.\nAn alternative to lengthy documentation?\nNo one reads.\nIf someone does read, he doesn’t understand.\nIf he understands, he immediately forgets.\nUnfortunately, just as is the case in the above quote from Stanisław Lem 2, the problem with documentation, procedures, and ADRs is that people need to\nfamiliarize themselves with them. I suppose that even at SpaceX, it’s doubtful this would be considered the most thrilling reading material, or maybe I am just\nmistaken. Anyway, even if someone manages to get through the documentation, they’ll only retain what they understand. We’re presented with the work of others,\nwith their imposed ways of thinking and decision-making. Often, questions arise to which no one knows the answers, and the people who do know are no longer with\nthe company.\nSince we now know our mental limitations, instead of forcing people to sift through stacks of documentation, we can\nuse EventStorming. This technique helps understand business processes, identify events and\nactivities, and integrate knowledge in an understandable way. We focus on behaviors, on what changes and why. Together, we develop a solution and understand the\nprocesses because we see them from start to finish. Understanding a process through EventStorming is faster and easier than reading documentation. During an\nEventStorming session, most questions find answers, and knowledge can be conveyed to many people simultaneously, whether they are technical or not. The most\nsignificant artifact of such sessions is that you can discuss why the process looks the way it does, why a specific sequence was chosen, and not another —\nessentially, a mega-mix of documentation, ADR, and conversation. I emphasize once more that this understanding of the process is developed collectively —\neveryone feels as a part of the solution. In the case of our BDS, EventStorming is like capturing the thoughts of experts when making crucial decisions.\nReal life example\nAt Allegro, we recently had a situation where the entire development team responsible for a critical service was moved to a different\nproject. The new team, which inherited the service, had the opportunity to collaborate with the departing team for a period. However, in this context, we also\nconducted EventStorming sessions. To provide more detail, these sessions extended over two full days, each lasting 8 hours. The knowledge accumulated over the\npast five years was not merely confined to two plotter paper-sized sheets, each stretching 6 meters in length, but was primarily assimilated within the\nparticipants’ minds in a seamless manner. I believe this facilitated the new team in gaining greater confidence when taking over the domain.\nInterestingly, you don’t need to spend a lot of time on EventStorming to uncover enough business knowledge. In the case mentioned earlier, the session lasted\ntwo days, but it involved an entire team. For an individual, a two-hour workshop can be enough to see the big picture of our process. Although EventStorming\nallows us to absorb a dose of knowledge relatively easily to know what and why is changing in our process, the devil is in the detail. To really understand\nhow this process is changing, it’s best to start by doing small tasks under the guidance of an experienced person.\nSeeking UML-like Alternatives?\nUnfortunately, EventStorming is not the answer to all knowledge loss-related problems. While I don’t question how fantastic this tool is, the knowledge acquired\nthrough it will remain only in the participants’ minds. If it’s not somehow preserved in the form of documentation or ADRs, it may turn out to be just as\nfleeting as departing employees. What can be done about this? Our initial thoughts may lead us to create some form of description or documentation, which, as we\nknow, comes with the challenge of its preparation and the cognitive overload for someone trying to assimilate new knowledge.\nIt seems that when dealing with the issue of knowledge loss and its effective transfer, it’s worth mentioning tools like BPMN, which stands for Business Process\nModel and Notation. BPMN provides a standardized graphical representation of business processes. By using BPMN diagrams, we can visually map\nworkflows and procedures. Such an approach not only simplifies the understanding of complex processes but also aids in comprehensive documentation. When\ncombined with other knowledge-sharing techniques, such as EventStorming, BPMN can be a powerful asset in preserving and transferring critical business\nknowledge.\nHowever, BPMN has an elaborate set of symbols and notation rules, which can make creating and interpreting diagrams complicated for some individuals. Creating\nadvanced BPMN diagrams and fully utilizing the notation’s potential requires specialized knowledge and experience. People unfamiliar with BPMN may struggle\nto use it effectively. Despite these inconveniences, BPMN still remains a valuable tool for modeling and documenting business processes in many organizations. I\nbelieve it complements the previously mentioned techniques perfectly.\nJust remember to have the right tools in your arsenal and, more importantly, to choose the appropriate tool for the situation, considering both its strengths\nand weaknesses.\nOne more thing…\nTime to Problem Resolution metric serves as a clear indicator of an organization’s efficiency in addressing challenges. A shorter time to resolution signifies\nthat issues are tackled swiftly, minimizing disruptions and ensuring that the organization operates smoothly.\nKnowledge Transfer Rate metric is a means to quantify and address the loss of knowledge, shedding light on its impact on communication structures and system\ndesign within an organization.\nBoth metrics are directly influenced by the use of appropriate tools such as documentation, ADRs, EventStorming or BPMN. I have tried to highlight their\nadvantages and disadvantages in the context of knowledge transfer.\nHowever, there is another challenge - changing the company’s culture. Employees must know what tools they have and feel that sharing knowledge is key to\nsuccess. Leadership plays a crucial role here, as leaders need to actively promote and engage in knowledge sharing and open communication. If company leaders\nactively endorse and engage in knowledge sharing, other employees are more likely to follow suit. However, changing organizational culture is a time-consuming\nprocess. Patience and perseverance are essential until new behaviors and beliefs prevail over old ones.\nThis can be done\nAs an engineer in an organisation, regardless of size, there are several proactive steps you can take to facilitate knowledge transfer. First and foremost,\nactively engage in open communication with your colleagues. Encourage discussion and information sharing, especially within your area of expertise, to ensure\nthat valuable insights are shared. Second, mentorship can be a powerful tool. Offer to mentor junior team members or be open to seeking guidance from more\nexperienced colleagues. In addition, participate in knowledge-sharing initiatives within the company, such as brown bag sessions, workshops or cross-functional\nprojects. Finally, consider creating or contributing to internal documentation and repositories. These resources can serve as valuable references for your\ncolleagues and future team members, ensuring that knowledge is retained within the organisation. By actively participating in these practices, you can play a\nkey role in preserving and transferring critical knowledge within your organisation.\nSummary\nIn this article, I aimed to discuss how knowledge loss in a company appears through an engineer’s eyes and why it can pose a threat. The term Biological Data\nStorage may sound unconventional, but it emphasises the critical role that every team member plays in preserving and transferring knowledge. It’s important to\nremember that employees are not just resources; they are the living repositories of valuable information, experience and expertise. In the world of BDS, every\nmember contributes to the collective body of knowledge, shaping the organisation’s communication structure.\nAs we say goodbye to departing colleagues, let’s also say goodbye to the notion that knowledge should be confined to individual minds. Instead, let’s adopt a\nculture of open communication, active knowledge sharing and the right tools, such as EventStorming and BPMN, to capture, preserve and share critical knowledge\nacross our organisation.\nFootnotes\nQuote from https://en.wikipedia.org/wiki/Conway%27s_law ↩\nhttps://en.wikipedia.org/wiki/Stanis%C5%82aw_Lem ↩","guid":"https://blog.allegro.tech/2023/10/battle-against-knowledge-loss.html","categories":["eventstorming","knowledge-preservation","tech","communication"],"isoDate":"2023-10-29T23:00:00.000Z","thumbnail":"images/post-headers/eventstorming.png"},{"title":"Online MongoDB migration","link":"https://blog.allegro.tech/2023/09/online-mongodb-migration.html","pubDate":"Thu, 14 Sep 2023 00:00:00 +0200","authors":{"author":[{"name":["Szymon Marcinkiewicz"],"photo":["https://blog.allegro.tech/img/authors/szymon.marcinkiewicz.jpg"],"url":["https://blog.allegro.tech/authors/szymon.marcinkiewicz"]}]},"content":"\u003cp\u003eMongoDB is the most popular database used at \u003ca href=\"https://allegro.tech\"\u003eAllegro\u003c/a\u003e. We have hundreds of MongoDB databases running on our on—premise servers.\nIn 2022 we decided that we need to migrate all our MongoDB databases\nfrom existing shared clusters to new MongoDB clusters hosted on Kubernetes pods with separated resources.\nTo perform the migration of all databases we needed a tool for transfering all the data and keeping consistency between old and new databases.\nThat’s how \u003cem\u003emongo-migration-stream\u003c/em\u003e project was born.\u003c/p\u003e\n\n\u003ch2 id=\"why-do-we-needed-to-migrate-mongodb-databases-at-all\"\u003eWhy do we needed to migrate MongoDB databases at all?\u003c/h2\u003e\n\n\u003cp\u003eAt Allegro we are managing tens of MongoDB clusters, with hundreds of MongoDB databases running on them.\nThis kind of approach, where one MongoDB cluster runs multiple MongoDB databases, allowed us to utilize resources\nmore effectively, while at the same time easing maintenance of clusters.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/one_cluster_multiple_databases.png\" alt=\"Old approach\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eWe’ve been living with this approach for years, but over time, more and more databases were\ncreated on shared clusters, increasing the frequency of the noisy neighbour problem.\u003c/p\u003e\n\n\u003ch3 id=\"noisy-neighbour-problem\"\u003eNoisy neighbour problem\u003c/h3\u003e\n\n\u003cp\u003eGenerally speaking, a noisy neighbour situation appears while multiple applications run on shared infrastructure,\nand one of those applications starts to consume so many resources (like CPU, RAM or Storage),\nthat it causes starvation of other applications.\u003c/p\u003e\n\n\u003cp\u003eAt Allegro this problem started to be visible because over the years we’ve created more and more new MongoDB databases\nwhich were hosted on a fixed number of clusters.\u003c/p\u003e\n\n\u003cp\u003eThe most common cause of the noisy neighbour problem in the Allegro infrastructure was long time high CPU usage caused by one of MongoDB databases on a given cluster.\nOn various occasions it occurred that a non-optimal query performed on a large collection was consuming too much CPU,\nnegatively affecting all the other databases on that cluster, making them slower or completely unresponsive.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/cluster_cpu.png\" alt=\"Cluster CPU usage\" /\u003e\u003c/p\u003e\n\n\u003ch3 id=\"mongodb-on-kubernetes-as-a-solution-to-the-noisy-neighbour-problem\"\u003eMongoDB on Kubernetes as a solution to the noisy neighbour problem\u003c/h3\u003e\n\n\u003cp\u003eTo solve the noisy neighbour problem a separate team implemented a solution allowing Allegro engineers to create independent MongoDB clusters on Kubernetes.\nFrom now on, each MongoDB cluster is formed of multiple replicas and an arbiter spread among datacenters, serving only a single MongoDB database.\nRunning each database on a separate cluster with isolated resources managed by Kubernetes was our solution to the noisy neighbour problem.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/k8s_cpu.png\" alt=\"Kubernetes CPU usage\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eAt this point we knew what we needed to do to solve our problems — we had to migrate all MongoDB databases from old shared clusters\nto new independent clusters on Kubernetes. Now came the time to answer the question: \u003cem\u003eHow should we do it?\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2 id=\"available-options\"\u003eAvailable options\u003c/h2\u003e\n\n\u003cp\u003eFirstly, we prepared a list of requirements which a tool for migrating databases (referred to as \u003cem\u003emigrator\u003c/em\u003e) had to meet in order to perform\nsuccessful migrations.\u003c/p\u003e\n\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\n\u003cul\u003e\n  \u003cli\u003eMigrator must be able to migrate databases from older MongoDB versions to newer ones,\u003c/li\u003e\n  \u003cli\u003eMigrator must be able to migrate \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eReplicaSets\u003c/code\u003e and sharded clusters,\u003c/li\u003e\n  \u003cli\u003eMigrator must copy indexes from source database to destination database,\u003c/li\u003e\n  \u003cli\u003eMigrator must be able to handle more than 10k write operations per second,\u003c/li\u003e\n  \u003cli\u003eMigration must be performed without any downtime,\u003c/li\u003e\n  \u003cli\u003eMigration cannot affect database clients,\u003c/li\u003e\n  \u003cli\u003eDatabase owners (software engineers) need to be able to perform migrations on their own.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"existing-solutions\"\u003eExisting solutions\u003c/h3\u003e\n\n\u003cp\u003eHaving defined a list of requirements, we checked what tools were available on the market at the time.\u003c/p\u003e\n\n\u003ch4 id=\"py-mongo-sync\"\u003e\u003ca href=\"https://github.com/caosiyang/py-mongo-sync\"\u003epy-mongo-sync\u003c/a\u003e\u003c/h4\u003e\n\n\u003cp\u003eAccording to documentation \u003cem\u003epy-mongo-sync\u003c/em\u003e is:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e“Oplog—based data sync tool that synchronizes data from a replica set to another deployment,\ne.g.: standalone, replica set, and sharded cluster.”\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAs you can see, \u003cem\u003epy-mongo-sync\u003c/em\u003e is not a tool that would suit our needs from end to end.\n\u003cem\u003epy-mongo-sync\u003c/em\u003e focuses on the synchronization of the data stored on the \u003cem\u003esource database\u003c/em\u003e after starting the tool.\nIt doesn’t copy already existing data from the \u003cem\u003esource\u003c/em\u003e to the \u003cem\u003edestination database\u003c/em\u003e.\nWhat’s more, at the time \u003cem\u003epy-mongo-sync\u003c/em\u003e supported MongoDB versions between 2.4 to 3.4, which were older than those used at Allegro.\u003c/p\u003e\n\n\u003ch4 id=\"mongodb-cluster-to-cluster-sync\"\u003e\u003ca href=\"https://www.mongodb.com/docs/cluster-to-cluster-sync/current/\"\u003eMongoDB Cluster-to-Cluster Sync\u003c/a\u003e\u003c/h4\u003e\n\n\u003cp\u003eOn July 22, 2022 MongoDB released \u003cem\u003emongosync\u003c/em\u003e v1.0 — a tool for migrating and synchronizing data between MongoDB clusters.\nAs described in the \u003cem\u003emongosync\u003c/em\u003e documentation:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e“The mongosync binary is the primary process used in Cluster—to—Cluster Sync. mongosync migrates data from one cluster\nto another and can keep the clusters in continuous sync.”\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis description sounded like a perfect fit for us! Unfortunately, after initial excitement\n(and hours spent on reading \u003ca href=\"https://www.mongodb.com/docs/cluster-to-cluster-sync/current/reference/mongosync/\"\u003e\u003cem\u003emongosync\u003c/em\u003e documentation\u003c/a\u003e)\nwe realized we couldn’t use \u003cem\u003emongosync\u003c/em\u003e as it was able to perform migration and synchronization process only if source database and destination database\nwere both in the exact same version.\nIt meant that there was no option to migrate databases from older MongoDB versions to the newest one, which was a no-go for us.\u003c/p\u003e\n\n\u003cp\u003eWhen we realised that there wasn’t a tool which met all our requirements, we made a tough decision to implement our own online MongoDB migration tool\nnamed \u003cem\u003emongo-migration-stream\u003c/em\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"mongo-migration-stream\"\u003emongo-migration-stream\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/allegro/mongo-migration-stream\"\u003e\u003cem\u003emongo-migration-stream\u003c/em\u003e\u003c/a\u003e is an open source tool from Allegro, that performs online migrations of MongoDB databases.\nIt’s a \u003ca href=\"https://kotlinlang.org/\"\u003eKotlin\u003c/a\u003e application utilising\n\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e \u003ca href=\"https://www.mongodb.com/docs/database-tools/\"\u003eMongoDB Command Line Database Tools\u003c/a\u003e\nalong with \u003ca href=\"https://www.mongodb.com/docs/manual/changeStreams/\"\u003eMongo Change Streams\u003c/a\u003e mechanism.\nIn this section I will explain how \u003cem\u003emongo-migration-stream\u003c/em\u003e works under the hood, by covering its functionalities from a high—level overview and\nproviding details about its low—level implementation.\u003c/p\u003e\n\n\u003ch3 id=\"mongo-migration-stream-terminology\"\u003emongo-migration-stream terminology\u003c/h3\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003cem\u003eSource database\u003c/em\u003e - MongoDB database which is a data source for migration,\u003c/li\u003e\n  \u003cli\u003e\u003cem\u003eDestination database\u003c/em\u003e - MongoDB database which is a target for the data from \u003cem\u003esource database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003e\u003cem\u003eTransfer\u003c/em\u003e - a process of dumping data from \u003cem\u003esource database\u003c/em\u003e, and restoring it on \u003cem\u003edestination database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003e\u003cem\u003eSynchronization\u003c/em\u003e - a process of keeping eventual consistency between \u003cem\u003esource database\u003c/em\u003e and \u003cem\u003edestination database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003e\u003cem\u003eMigration\u003c/em\u003e - an end-to-end migration process combining both \u003cem\u003etransfer\u003c/em\u003e and \u003cem\u003esynchronization\u003c/em\u003e processes,\u003c/li\u003e\n  \u003cli\u003e\u003cem\u003eMigrator\u003c/em\u003e - a tool for performing \u003cem\u003emigrations\u003c/em\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"building-blocks\"\u003eBuilding blocks\u003c/h3\u003e\n\n\u003cp\u003eAs I’ve mentioned at the beginning of this section, \u003cem\u003emongo-migration-stream\u003c/em\u003e utilises \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e, \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e, Mongo Change Streams\nand a custom Kotlin application to perform migrations.\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e is used to dump \u003cem\u003esource database\u003c/em\u003e in form of a binary file,\u003c/li\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e is used to restore previously created dump on \u003cem\u003edestination database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003eMongo Change Streams are used to keep eventual consistency between \u003cem\u003esource database\u003c/em\u003e and \u003cem\u003edestination database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003eKotlin application orchestrates, manages, and monitors all above processes.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e are responsible for the \u003cem\u003etransfer\u003c/em\u003e part of migration,\nwhile Mongo Change Streams play the main role in the \u003cem\u003esynchronization\u003c/em\u003e process.\u003c/p\u003e\n\n\u003ch3 id=\"birds-eye-view\"\u003eBird’s eye view\u003c/h3\u003e\n\n\u003cp\u003eTo implement a \u003cem\u003emigrator\u003c/em\u003e, we needed a robust procedure for \u003cem\u003emigrations\u003c/em\u003e which ensures that no data is lost during a \u003cem\u003emigration\u003c/em\u003e.\nWe have formulated a procedure consisting of six consecutive steps:\u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003eStart listening for Mongo Change Events on \u003cem\u003esource database\u003c/em\u003e and save them in the queue,\u003c/li\u003e\n  \u003cli\u003eDump all the data from \u003cem\u003esource database\u003c/em\u003e using \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e,\u003c/li\u003e\n  \u003cli\u003eRestore all the data on \u003cem\u003edestination database\u003c/em\u003e using \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e,\u003c/li\u003e\n  \u003cli\u003eCopy indexes definitions from \u003cem\u003esource database\u003c/em\u003e and start creating them on \u003cem\u003edestination database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003eStart to push all the events stored in the queue (changes on \u003cem\u003esource database\u003c/em\u003e) to the \u003cem\u003edestination database\u003c/em\u003e,\u003c/li\u003e\n  \u003cli\u003eWait for the queue to empty to establish eventual consistency.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/migration_process.png\" alt=\"Migration process\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eOur migration procedure works flawlessly because processing Mongo Change Events in a sequence guarantees migration idempotency.\nWithout this characteristic, we would have to change the order of steps 1 and 2 in the procedure, creating a possibility of losing data during migration.\u003c/p\u003e\n\n\u003cp\u003eTo explain this problem in more detail, let’s assume that the \u003cem\u003esource database\u003c/em\u003e deals with a continuous high volume of writes.\nIf we had started the migration by performing dump in the first place and then started to listen for events,\nwe would have lost the events stored on the \u003cem\u003esource database\u003c/em\u003e in the meantime.\nHowever, as we start the migration by listening for events on the \u003cem\u003esource database\u003c/em\u003e, and then proceeding with the dump,\nwe do not lose any of the events stored on the \u003cem\u003esource database\u003c/em\u003e during that time.\u003c/p\u003e\n\n\u003cp\u003eThe diagram below presents how such a kind of \u003cem\u003ewrite anomaly\u003c/em\u003e could happen if we started dumping data before listening for Mongo Change Events.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/avoiding_event_loss.png\" alt=\"Avoiding event loss\" /\u003e\u003c/p\u003e\n\n\u003ch3 id=\"implementation-details\"\u003eImplementation details\u003c/h3\u003e\n\n\u003ch4 id=\"concurrency\"\u003eConcurrency\u003c/h4\u003e\n\n\u003cp\u003eFrom the beginning we wanted to make \u003cem\u003emongo-migration-stream\u003c/em\u003e fast — we knew that it would need to cope with databases having more than 10k writes per second.\nAs a result \u003cem\u003emongo-migration-stream\u003c/em\u003e parallelizes migration of one MongoDB database into independent migrations of collections.\nEach database migration consists of multiple little \u003cem\u003emigrators\u003c/em\u003e — one \u003cem\u003emigrator\u003c/em\u003e per collection in the database.\u003c/p\u003e\n\n\u003cp\u003eThe \u003cem\u003etransfer\u003c/em\u003e process is performed in parallel for each collection, in separate \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e processes.\n\u003cem\u003eSynchronization\u003c/em\u003e process was also implemented concurrently — at the beginning of migration, each collection on \u003cem\u003esource database\u003c/em\u003e is watched individually\nusing \u003ca href=\"https://www.mongodb.com/docs/manual/changeStreams/#watch-a-collection--database--or-deployment\"\u003eMongo Change Streams with collection target\u003c/a\u003e.\nAll collections have their own separate queues in which Mongo Change Events are stored.\nAt the final phase of migration, each of these queues is processed independently.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/concurrent_migrations.png\" alt=\"Concurrent migrations\" /\u003e\u003c/p\u003e\n\n\u003ch4 id=\"initial-data-transfer\"\u003eInitial data transfer\u003c/h4\u003e\n\n\u003cp\u003eTo perform transfer of the database, we’re executing \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e commands for each collection.\nFor that reason, machines on which \u003cem\u003emongo-migration-stream\u003c/em\u003e is running are required to have MongoDB Command Line Database Tools installed.\u003c/p\u003e\n\n\u003cp\u003eDumping data from collection \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecollectionName\u003c/code\u003e in \u003ccode class=\"language-plaintext highlighter-rouge\"\u003esource\u003c/code\u003e database can be achieved by running a command:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003emongodump \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--uri\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"mongodb://mongo_rs36_1:36301,mongo_rs36_2:36302,mongo_rs36_3:36303/?replicaSet=replicaSet36\"\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--db\u003c/span\u003e \u003cspan class=\"nb\"\u003esource\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--collection\u003c/span\u003e collectionName \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--out\u003c/span\u003e /home/user/mongomigrationstream/dumps \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--readPreference\u003c/span\u003e secondary\n \u003cspan class=\"nt\"\u003e--username\u003c/span\u003e username \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--config\u003c/span\u003e /home/user/mongomigrationstream/password_config/dump.config \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e--authenticationDatabase\u003c/span\u003e admin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eStarting a \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e process from Kotlin code is done with Java’s \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eProcessBuilder\u003c/code\u003e feature.\n\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eProcessBuilder\u003c/code\u003e requires us to provide a process program and arguments in the form of a list of Strings.\nWe construct this list using \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eprepareCommand\u003c/code\u003e function:\u003c/p\u003e\n\n\u003cdiv class=\"language-kotlin highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003eprepareCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003elistOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emongoToolsPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\"mongodump\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"--uri\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edbProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"--db\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edbCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edbName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"--collection\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edbCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecollectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"--out\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edumpPath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"--readPreference\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ereadPreference\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"nf\"\u003ecredentialsIfNotNull\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edbProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eauthenticationProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epasswordConfigPath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eHaving \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eProcessBuilder\u003c/code\u003e with properly configured list of process program and arguments, we’re ready to start a new process\nusing the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003estart()\u003c/code\u003e function.\u003c/p\u003e\n\n\u003cdiv class=\"language-kotlin highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003erunCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nc\"\u003eCommandResult\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eval\u003c/span\u003e \u003cspan class=\"py\"\u003eprocessBuilder\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eProcessBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eprepareCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Configure ProcessBuilder with mongodump command in form of List\u0026lt;String\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecurrentProcess\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eprocessBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Start a new process\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// ...\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eval\u003c/span\u003e \u003cspan class=\"py\"\u003eexitCode\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecurrentProcess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewaitFor\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"nf\"\u003estopRunningCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eCommandResult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eexitCode\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eAn analogous approach is implemented in \u003cem\u003emongo-migration-stream\u003c/em\u003e to execute the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e command.\u003c/p\u003e\n\n\u003ch4 id=\"event-queue\"\u003eEvent queue\u003c/h4\u003e\n\n\u003cp\u003eDuring the process of migration \u003cem\u003esource database\u003c/em\u003e can constantly receive changes, which \u003cem\u003emongo-migration-stream\u003c/em\u003e is listening to with Mongo Change Streams.\nEvents from the stream are saved in the queue for sending to the \u003cem\u003edestination database\u003c/em\u003e at a later time.\nCurrently \u003cem\u003emongo-migration-stream\u003c/em\u003e provides two implementations of the queue,\nwhere one implementation stores the data in RAM, while the other one persists the data to disk.\u003c/p\u003e\n\n\u003cp\u003eIn-memory implementation can be used for databases with low traffic, or for testing purposes,\nor on machines with a sufficient amount of RAM (as events are stored as objects on the JVM heap).\u003c/p\u003e\n\n\u003cdiv class=\"language-kotlin highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// In-memory queue implementation\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eInMemoryEventQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eEventQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003eval\u003c/span\u003e \u003cspan class=\"py\"\u003equeue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eConcurrentLinkedQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;()\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003eoffer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nc\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eoffer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003epoll\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epoll\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003epeek\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epeek\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eInt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003eremoveAll\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eremoveAll\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eIn our production setup we decided to use a persistent event queue, which is implemented on top of \u003ca href=\"https://github.com/bulldog2011/bigqueue\"\u003eBigQueue project\u003c/a\u003e.\nAs BigQueue only allows enqueuing and dequeuing byte arrays, we had to implement serialization and deserialization of the data from the events.\u003c/p\u003e\n\n\u003cdiv class=\"language-kotlin highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// Persistent queue implementation\u003c/span\u003e\n\u003cspan class=\"k\"\u003einternal\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBigQueueEventQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eE\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eSerializable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equeueName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eEventQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003eval\u003c/span\u003e \u003cspan class=\"py\"\u003equeue\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eBigQueueImpl\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003equeueName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003eoffer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nc\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eenqueue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etoByteArray\u003c/span\u003e\u003cspan class=\"p\"\u003e()).\u003c/span\u003e\u003cspan class=\"nf\"\u003elet\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003epoll\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edequeue\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003etoE\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003epeek\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epeek\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003etoE\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eInt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003etoInt\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003eremoveAll\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eremoveAll\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003equeue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egc\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etoByteArray\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eByteArray\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eSerializationUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nc\"\u003eByteArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etoE\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e \u003cspan class=\"nc\"\u003eE\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eSerializationUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edeserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4 id=\"migrating-indexes\"\u003eMigrating indexes\u003c/h4\u003e\n\n\u003cp\u003eIn early versions of \u003cem\u003emongo-migration-stream\u003c/em\u003e, to copy indexes from \u003cem\u003esource collection\u003c/em\u003e to \u003cem\u003edestination collection\u003c/em\u003e, we used\nan \u003ca href=\"https://www.mongodb.com/docs/database-tools/mongorestore/#rebuild-indexes\"\u003eindex rebuilding feature\u003c/a\u003e from \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e tools.\nThis feature works on the principle that the result of \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e consists of both documents from the collection and definitions of indexes.\n\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e can use those definitions to rebuild indexes on \u003cem\u003edestination collection\u003c/em\u003e.\u003c/p\u003e\n\n\u003cp\u003eUnfortunately it occurred that rebuilding indexes on \u003cem\u003edestination collection\u003c/em\u003e after \u003cem\u003etransfer\u003c/em\u003e phase (before starting \u003cem\u003esynchronization\u003c/em\u003e process)\nwith the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e tool lengthened the entire \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e process, preventing us from emptying the queue in the meantime.\nIt resulted in a growing queue of events to synchronize, ending up with overall longer migration times and higher resources utilisation.\nWe’ve come to the conclusion, that we must rebuild indexes, while at the same time, keep sending events from the queue to \u003cem\u003edestination collection\u003c/em\u003e.\u003c/p\u003e\n\n\u003cp\u003eTo migrate indexes without blocking \u003cem\u003emigration\u003c/em\u003e process, we implemented a solution which for each collection,\nfetches all its indexes, and rebuilds them on \u003cem\u003edestination collection\u003c/em\u003e.\nLooking from the application perspective, we use \u003ccode class=\"language-plaintext highlighter-rouge\"\u003egetRawSourceIndexes\u003c/code\u003e function to fetch a list of Documents\n(representing indexes definitions) from \u003cem\u003esource collection\u003c/em\u003e,\nand then recreate them on \u003cem\u003edestination collection\u003c/em\u003e using \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecreateIndexOnDestinationCollection\u003c/code\u003e.\u003c/p\u003e\n\n\u003cdiv class=\"language-kotlin highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003egetRawSourceIndexes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esourceToDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eSourceToDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nc\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nc\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esourceDb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egetCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esourceToDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecollectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003elistIndexes\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etoList\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efilterNot\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"key\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eDocument\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ejava\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"nc\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"_id\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emap\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eremove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"ns\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eremove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"v\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\"background\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eit\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efun\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreateIndexOnDestinationCollection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esourceToDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eSourceToDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eindexDefinition\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nc\"\u003eDocument\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edestinationDb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erunCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eDocument\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nf\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"createIndexes\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esourceToDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edestination\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecollectionName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"indexes\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003elistOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindexDefinition\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eOur solution can rebuild indexes in both older and newer versions of MongoDB.\nTo support older MongoDB versions we specify \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e{ background: true }\u003c/code\u003e option, which does not block all operations on a given database during index creation.\nIn case where \u003cem\u003edestination database\u003c/em\u003e is newer than or equal to MongoDB 4.2, the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e{ background: true }\u003c/code\u003e option is ignored, and\n\u003ca href=\"https://www.mongodb.com/docs/manual/core/index-creation/#comparison-to-foreground-and-background-builds\"\u003eoptimized index build is used\u003c/a\u003e.\nIn both scenarios rebuilding indexes does not block \u003cem\u003esynchronization\u003c/em\u003e process, improving overall \u003cem\u003emigration\u003c/em\u003e times.\u003c/p\u003e\n\n\u003ch4 id=\"verification-of-migration-state\"\u003eVerification of migration state\u003c/h4\u003e\n\n\u003cp\u003eThrought \u003cem\u003emongo-migration-stream\u003c/em\u003e implementation we kept in mind that \u003cem\u003emigrator\u003c/em\u003e user should be aware what’s happening within his/her migration.\nFor that purpose \u003cem\u003emongo-migration-stream\u003c/em\u003e exposes data about migration in multiple different ways:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\n    \u003cp\u003eLogs — \u003cem\u003emigrator\u003c/em\u003e logs all important information, so user can verify what’s going on,\u003c/p\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\n    \u003cp\u003ePeriodical checks — when all migrated collections are in \u003cem\u003esynchronization\u003c/em\u003e process, \u003cem\u003emigrator\u003c/em\u003e starts a periodical check for each collection, verifying if all the data has been migrated, making collection on \u003cem\u003edestination database\u003c/em\u003e ready to use,\u003c/p\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\n    \u003cp\u003eMetrics — various metrics about migration state are exposed through \u003ca href=\"https://micrometer.io/\"\u003eMicrometer\u003c/a\u003e.\u003c/p\u003e\n  \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOn top of all that, each migrator internal state change emits an event to in—memory event bus. There are multiple types of events which \u003cem\u003emongo-migration-stream\u003c/em\u003e produces:\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003eEvent type\u003c/th\u003e\n      \u003cth\u003eWhen the event is emitted\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eStartEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStart of the migration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eSourceToLocalStartEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStart watching for a collection specific Mongo Change Stream\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eDumpStartEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStart \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e for a collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eDumpUpdateEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eEach \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e print to stdout\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eDumpFinishEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eFinish \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongodump\u003c/code\u003e for a collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eRestoreStartEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStart \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e for a collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eRestoreUpdateEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eEach \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e print to stdout\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eRestoreFinishEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eFinish \u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongorestore\u003c/code\u003e for a collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eIndexRebuildStartEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStart rebuilding indexes for a collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eIndexRebuildFinishEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eFinish rebuilding indexes for a collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eLocalToDestinationStartEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStart sending events from queue to destination collection\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eStopEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eStop of the migration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ePauseEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003ePause of the migration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eResumeEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eResume of paused migration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eFailedEvent\u003c/code\u003e\u003c/td\u003e\n      \u003ctd\u003eFail of collection migration\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch4 id=\"application-modules\"\u003eApplication modules\u003c/h4\u003e\n\n\u003cp\u003e\u003cem\u003emongo-migration-stream\u003c/em\u003e code was split into two separate modules:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongo-migration-stream-core\u003c/code\u003e module which can be used as a library in JVM application,\u003c/li\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emongo-migration-stream-cli\u003c/code\u003e module which can be run as a standalone JAR.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"mongo-migration-stream-in-production-at-allegro\"\u003emongo-migration-stream in production at Allegro\u003c/h2\u003e\n\n\u003cp\u003eSince internal launch in January 2023, we have migrated more than a hundred production databases using \u003cem\u003emongo-migration-stream\u003c/em\u003e.\nThe largest migrated collection stored more than one and a half billion documents.\nAt its peak moments, \u003cem\u003emigrator\u003c/em\u003e was synchronizing a collection which emitted about 4 thousand Mongo Change Events per second.\nDuring one of our migrations, one collection queue size reached almost one hundred million events.\nAll of those events were later successfully synchronized into \u003cem\u003edestination collection\u003c/em\u003e.\u003c/p\u003e\n\n\u003cp\u003eAt Allegro we use \u003cem\u003emongo-migration-stream\u003c/em\u003e as a library in a Web application with graphical user interface.\nThis approach allows Allegro engineers to manage database migrations on their own, without involving database team members.\nOn the screenshot below you can see our Web application GUI during a migration.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-09-14-online-mongodb-migration/mongo_migration_stream_ui.png\" alt=\"mongo-migration-stream Web Application at Allegro\" /\u003e\u003c/p\u003e\n","contentSnippet":"MongoDB is the most popular database used at Allegro. We have hundreds of MongoDB databases running on our on—premise servers.\nIn 2022 we decided that we need to migrate all our MongoDB databases\nfrom existing shared clusters to new MongoDB clusters hosted on Kubernetes pods with separated resources.\nTo perform the migration of all databases we needed a tool for transfering all the data and keeping consistency between old and new databases.\nThat’s how mongo-migration-stream project was born.\nWhy do we needed to migrate MongoDB databases at all?\nAt Allegro we are managing tens of MongoDB clusters, with hundreds of MongoDB databases running on them.\nThis kind of approach, where one MongoDB cluster runs multiple MongoDB databases, allowed us to utilize resources\nmore effectively, while at the same time easing maintenance of clusters.\n\nWe’ve been living with this approach for years, but over time, more and more databases were\ncreated on shared clusters, increasing the frequency of the noisy neighbour problem.\nNoisy neighbour problem\nGenerally speaking, a noisy neighbour situation appears while multiple applications run on shared infrastructure,\nand one of those applications starts to consume so many resources (like CPU, RAM or Storage),\nthat it causes starvation of other applications.\nAt Allegro this problem started to be visible because over the years we’ve created more and more new MongoDB databases\nwhich were hosted on a fixed number of clusters.\nThe most common cause of the noisy neighbour problem in the Allegro infrastructure was long time high CPU usage caused by one of MongoDB databases on a given cluster.\nOn various occasions it occurred that a non-optimal query performed on a large collection was consuming too much CPU,\nnegatively affecting all the other databases on that cluster, making them slower or completely unresponsive.\n\nMongoDB on Kubernetes as a solution to the noisy neighbour problem\nTo solve the noisy neighbour problem a separate team implemented a solution allowing Allegro engineers to create independent MongoDB clusters on Kubernetes.\nFrom now on, each MongoDB cluster is formed of multiple replicas and an arbiter spread among datacenters, serving only a single MongoDB database.\nRunning each database on a separate cluster with isolated resources managed by Kubernetes was our solution to the noisy neighbour problem.\n\nAt this point we knew what we needed to do to solve our problems — we had to migrate all MongoDB databases from old shared clusters\nto new independent clusters on Kubernetes. Now came the time to answer the question: How should we do it?\nAvailable options\nFirstly, we prepared a list of requirements which a tool for migrating databases (referred to as migrator) had to meet in order to perform\nsuccessful migrations.\nRequirements\nMigrator must be able to migrate databases from older MongoDB versions to newer ones,\nMigrator must be able to migrate ReplicaSets and sharded clusters,\nMigrator must copy indexes from source database to destination database,\nMigrator must be able to handle more than 10k write operations per second,\nMigration must be performed without any downtime,\nMigration cannot affect database clients,\nDatabase owners (software engineers) need to be able to perform migrations on their own.\nExisting solutions\nHaving defined a list of requirements, we checked what tools were available on the market at the time.\npy-mongo-sync\nAccording to documentation py-mongo-sync is:\n“Oplog—based data sync tool that synchronizes data from a replica set to another deployment,\ne.g.: standalone, replica set, and sharded cluster.”\nAs you can see, py-mongo-sync is not a tool that would suit our needs from end to end.\npy-mongo-sync focuses on the synchronization of the data stored on the source database after starting the tool.\nIt doesn’t copy already existing data from the source to the destination database.\nWhat’s more, at the time py-mongo-sync supported MongoDB versions between 2.4 to 3.4, which were older than those used at Allegro.\nMongoDB Cluster-to-Cluster Sync\nOn July 22, 2022 MongoDB released mongosync v1.0 — a tool for migrating and synchronizing data between MongoDB clusters.\nAs described in the mongosync documentation:\n“The mongosync binary is the primary process used in Cluster—to—Cluster Sync. mongosync migrates data from one cluster\nto another and can keep the clusters in continuous sync.”\nThis description sounded like a perfect fit for us! Unfortunately, after initial excitement\n(and hours spent on reading mongosync documentation)\nwe realized we couldn’t use mongosync as it was able to perform migration and synchronization process only if source database and destination database\nwere both in the exact same version.\nIt meant that there was no option to migrate databases from older MongoDB versions to the newest one, which was a no-go for us.\nWhen we realised that there wasn’t a tool which met all our requirements, we made a tough decision to implement our own online MongoDB migration tool\nnamed mongo-migration-stream.\nmongo-migration-stream\nmongo-migration-stream is an open source tool from Allegro, that performs online migrations of MongoDB databases.\nIt’s a Kotlin application utilising\nmongodump and mongorestore MongoDB Command Line Database Tools\nalong with Mongo Change Streams mechanism.\nIn this section I will explain how mongo-migration-stream works under the hood, by covering its functionalities from a high—level overview and\nproviding details about its low—level implementation.\nmongo-migration-stream terminology\nSource database - MongoDB database which is a data source for migration,\nDestination database - MongoDB database which is a target for the data from source database,\nTransfer - a process of dumping data from source database, and restoring it on destination database,\nSynchronization - a process of keeping eventual consistency between source database and destination database,\nMigration - an end-to-end migration process combining both transfer and synchronization processes,\nMigrator - a tool for performing migrations.\nBuilding blocks\nAs I’ve mentioned at the beginning of this section, mongo-migration-stream utilises mongodump, mongorestore, Mongo Change Streams\nand a custom Kotlin application to perform migrations.\nmongodump is used to dump source database in form of a binary file,\nmongorestore is used to restore previously created dump on destination database,\nMongo Change Streams are used to keep eventual consistency between source database and destination database,\nKotlin application orchestrates, manages, and monitors all above processes.\nmongodump and mongorestore are responsible for the transfer part of migration,\nwhile Mongo Change Streams play the main role in the synchronization process.\nBird’s eye view\nTo implement a migrator, we needed a robust procedure for migrations which ensures that no data is lost during a migration.\nWe have formulated a procedure consisting of six consecutive steps:\nStart listening for Mongo Change Events on source database and save them in the queue,\nDump all the data from source database using mongodump,\nRestore all the data on destination database using mongorestore,\nCopy indexes definitions from source database and start creating them on destination database,\nStart to push all the events stored in the queue (changes on source database) to the destination database,\nWait for the queue to empty to establish eventual consistency.\n\nOur migration procedure works flawlessly because processing Mongo Change Events in a sequence guarantees migration idempotency.\nWithout this characteristic, we would have to change the order of steps 1 and 2 in the procedure, creating a possibility of losing data during migration.\nTo explain this problem in more detail, let’s assume that the source database deals with a continuous high volume of writes.\nIf we had started the migration by performing dump in the first place and then started to listen for events,\nwe would have lost the events stored on the source database in the meantime.\nHowever, as we start the migration by listening for events on the source database, and then proceeding with the dump,\nwe do not lose any of the events stored on the source database during that time.\nThe diagram below presents how such a kind of write anomaly could happen if we started dumping data before listening for Mongo Change Events.\n\nImplementation details\nConcurrency\nFrom the beginning we wanted to make mongo-migration-stream fast — we knew that it would need to cope with databases having more than 10k writes per second.\nAs a result mongo-migration-stream parallelizes migration of one MongoDB database into independent migrations of collections.\nEach database migration consists of multiple little migrators — one migrator per collection in the database.\nThe transfer process is performed in parallel for each collection, in separate mongodump and mongorestore processes.\nSynchronization process was also implemented concurrently — at the beginning of migration, each collection on source database is watched individually\nusing Mongo Change Streams with collection target.\nAll collections have their own separate queues in which Mongo Change Events are stored.\nAt the final phase of migration, each of these queues is processed independently.\n\nInitial data transfer\nTo perform transfer of the database, we’re executing mongodump and mongorestore commands for each collection.\nFor that reason, machines on which mongo-migration-stream is running are required to have MongoDB Command Line Database Tools installed.\nDumping data from collection collectionName in source database can be achieved by running a command:\n\nmongodump \\\n --uri \"mongodb://mongo_rs36_1:36301,mongo_rs36_2:36302,mongo_rs36_3:36303/?replicaSet=replicaSet36\" \\\n --db source \\\n --collection collectionName \\\n --out /home/user/mongomigrationstream/dumps \\\n --readPreference secondary\n --username username \\\n --config /home/user/mongomigrationstream/password_config/dump.config \\\n --authenticationDatabase admin\n\n\nStarting a mongodump process from Kotlin code is done with Java’s ProcessBuilder feature.\nProcessBuilder requires us to provide a process program and arguments in the form of a list of Strings.\nWe construct this list using prepareCommand function:\n\noverride fun prepareCommand(): List\u003cString\u003e = listOf(\n    mongoToolsPath + \"mongodump\",\n    \"--uri\", dbProperties.uri,\n    \"--db\", dbCollection.dbName,\n    \"--collection\", dbCollection.collectionName,\n    \"--out\", dumpPath,\n    \"--readPreference\", readPreference\n) + credentialsIfNotNull(dbProperties.authenticationProperties, passwordConfigPath)\n\n\nHaving ProcessBuilder with properly configured list of process program and arguments, we’re ready to start a new process\nusing the start() function.\n\nfun runCommand(command: Command): CommandResult {\n    val processBuilder = ProcessBuilder().command(command.prepareCommand()) // Configure ProcessBuilder with mongodump command in form of List\u003cString\u003e\n    currentProcess = processBuilder.start() // Start a new process\n    // ...\n    val exitCode = currentProcess.waitFor()\n    stopRunningCommand()\n    return CommandResult(exitCode)\n}\n\n\nAn analogous approach is implemented in mongo-migration-stream to execute the mongorestore command.\nEvent queue\nDuring the process of migration source database can constantly receive changes, which mongo-migration-stream is listening to with Mongo Change Streams.\nEvents from the stream are saved in the queue for sending to the destination database at a later time.\nCurrently mongo-migration-stream provides two implementations of the queue,\nwhere one implementation stores the data in RAM, while the other one persists the data to disk.\nIn-memory implementation can be used for databases with low traffic, or for testing purposes,\nor on machines with a sufficient amount of RAM (as events are stored as objects on the JVM heap).\n\n// In-memory queue implementation\ninternal class InMemoryEventQueue\u003cE\u003e : EventQueue\u003cE\u003e {\n    private val queue = ConcurrentLinkedQueue\u003cE\u003e()\n\n    override fun offer(element: E): Boolean = queue.offer(element)\n    override fun poll(): E = queue.poll()\n    override fun peek(): E = queue.peek()\n    override fun size(): Int = queue.size\n    override fun removeAll() {\n        queue.removeAll { true }\n    }\n}\n\n\nIn our production setup we decided to use a persistent event queue, which is implemented on top of BigQueue project.\nAs BigQueue only allows enqueuing and dequeuing byte arrays, we had to implement serialization and deserialization of the data from the events.\n\n// Persistent queue implementation\ninternal class BigQueueEventQueue\u003cE : Serializable\u003e(path: String, queueName: String) : EventQueue\u003cE\u003e {\n    private val queue = BigQueueImpl(path, queueName)\n\n    override fun offer(element: E): Boolean = queue.enqueue(element.toByteArray()).let { true }\n    override fun poll(): E = queue.dequeue().toE()\n    override fun peek(): E = queue.peek().toE()\n    override fun size(): Int = queue.size().toInt()\n    override fun removeAll() {\n        queue.removeAll()\n        queue.gc()\n    }\n\n    private fun E.toByteArray(): ByteArray = SerializationUtils.serialize(this)\n    private fun ByteArray.toE(): E = SerializationUtils.deserialize(this)\n}\n\n\nMigrating indexes\nIn early versions of mongo-migration-stream, to copy indexes from source collection to destination collection, we used\nan index rebuilding feature from mongodump and mongorestore tools.\nThis feature works on the principle that the result of mongodump consists of both documents from the collection and definitions of indexes.\nmongorestore can use those definitions to rebuild indexes on destination collection.\nUnfortunately it occurred that rebuilding indexes on destination collection after transfer phase (before starting synchronization process)\nwith the mongorestore tool lengthened the entire mongorestore process, preventing us from emptying the queue in the meantime.\nIt resulted in a growing queue of events to synchronize, ending up with overall longer migration times and higher resources utilisation.\nWe’ve come to the conclusion, that we must rebuild indexes, while at the same time, keep sending events from the queue to destination collection.\nTo migrate indexes without blocking migration process, we implemented a solution which for each collection,\nfetches all its indexes, and rebuilds them on destination collection.\nLooking from the application perspective, we use getRawSourceIndexes function to fetch a list of Documents\n(representing indexes definitions) from source collection,\nand then recreate them on destination collection using createIndexOnDestinationCollection.\n\nprivate fun getRawSourceIndexes(sourceToDestination: SourceToDestination): List\u003cDocument\u003e =\n    sourceDb.getCollection(sourceToDestination.source.collectionName).listIndexes()\n        .toList()\n        .filterNot { it.get(\"key\", Document::class.java) == Document().append(\"_id\", 1) }\n        .map {\n            it.remove(\"ns\")\n            it.remove(\"v\")\n            it[\"background\"] = true\n            it\n        }\n\nprivate fun createIndexOnDestinationCollection(\n    sourceToDestination: SourceToDestination,\n    indexDefinition: Document\n) {\n    destinationDb.runCommand(\n        Document().append(\"createIndexes\", sourceToDestination.destination.collectionName)\n            .append(\"indexes\", listOf(indexDefinition))\n    )\n}\n\n\nOur solution can rebuild indexes in both older and newer versions of MongoDB.\nTo support older MongoDB versions we specify { background: true } option, which does not block all operations on a given database during index creation.\nIn case where destination database is newer than or equal to MongoDB 4.2, the { background: true } option is ignored, and\noptimized index build is used.\nIn both scenarios rebuilding indexes does not block synchronization process, improving overall migration times.\nVerification of migration state\nThrought mongo-migration-stream implementation we kept in mind that migrator user should be aware what’s happening within his/her migration.\nFor that purpose mongo-migration-stream exposes data about migration in multiple different ways:\nLogs — migrator logs all important information, so user can verify what’s going on,\nPeriodical checks — when all migrated collections are in synchronization process, migrator starts a periodical check for each collection, verifying if all the data has been migrated, making collection on destination database ready to use,\nMetrics — various metrics about migration state are exposed through Micrometer.\nOn top of all that, each migrator internal state change emits an event to in—memory event bus. There are multiple types of events which mongo-migration-stream produces:\nEvent type\n      When the event is emitted\n    \nStartEvent\n      Start of the migration\n    \nSourceToLocalStartEvent\n      Start watching for a collection specific Mongo Change Stream\n    \nDumpStartEvent\n      Start mongodump for a collection\n    \nDumpUpdateEvent\n      Each mongodump print to stdout\n    \nDumpFinishEvent\n      Finish mongodump for a collection\n    \nRestoreStartEvent\n      Start mongorestore for a collection\n    \nRestoreUpdateEvent\n      Each mongorestore print to stdout\n    \nRestoreFinishEvent\n      Finish mongorestore for a collection\n    \nIndexRebuildStartEvent\n      Start rebuilding indexes for a collection\n    \nIndexRebuildFinishEvent\n      Finish rebuilding indexes for a collection\n    \nLocalToDestinationStartEvent\n      Start sending events from queue to destination collection\n    \nStopEvent\n      Stop of the migration\n    \nPauseEvent\n      Pause of the migration\n    \nResumeEvent\n      Resume of paused migration\n    \nFailedEvent\n      Fail of collection migration\n    \nApplication modules\nmongo-migration-stream code was split into two separate modules:\nmongo-migration-stream-core module which can be used as a library in JVM application,\nmongo-migration-stream-cli module which can be run as a standalone JAR.\nmongo-migration-stream in production at Allegro\nSince internal launch in January 2023, we have migrated more than a hundred production databases using mongo-migration-stream.\nThe largest migrated collection stored more than one and a half billion documents.\nAt its peak moments, migrator was synchronizing a collection which emitted about 4 thousand Mongo Change Events per second.\nDuring one of our migrations, one collection queue size reached almost one hundred million events.\nAll of those events were later successfully synchronized into destination collection.\nAt Allegro we use mongo-migration-stream as a library in a Web application with graphical user interface.\nThis approach allows Allegro engineers to manage database migrations on their own, without involving database team members.\nOn the screenshot below you can see our Web application GUI during a migration.","guid":"https://blog.allegro.tech/2023/09/online-mongodb-migration.html","categories":["tech","mongodb","nosql","kotlin","open source","mongo change streams"],"isoDate":"2023-09-13T22:00:00.000Z","thumbnail":"images/post-headers/mongodb.png"},{"title":"The Acrobatics of Switching Between Management and Engineering","link":"https://blog.allegro.tech/2023/08/management-engineering-acrobatics.html","pubDate":"Tue, 22 Aug 2023 00:00:00 +0200","authors":{"author":[{"name":["Michał Kosmulski"],"photo":["https://blog.allegro.tech/img/authors/michal.kosmulski.jpg"],"url":["https://blog.allegro.tech/authors/michal.kosmulski"]}]},"content":"\u003cp\u003eAfter six years as a Team Leader, I went back to hands-on engineering work, and I’m very happy about taking\nthis step. While it may appear surprising at first, it was a well-thought-out decision, and actually I’ve already\nperformed such a maneuver once before.\u003c/p\u003e\n\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\n\u003cp\u003eA few years ago I stumbled upon \u003ca href=\"https://charity.wtf/2017/05/11/the-engineer-manager-pendulum/\"\u003eThe Engineer/Manager Pendulum\u003c/a\u003e\nby Charity Majors, and the follow-up post \u003ca href=\"https://charity.wtf/2019/01/04/engineering-management-the-pendulum-or-the-ladder/\"\u003eEngineering Management: The Pendulum Or The Ladder\u003c/a\u003e.\nI found both pieces interesting, and quite in line with my own experiences: in my previous job some time earlier I\nhad been a team leader, but consciously joined \u003ca href=\"https://allegro.tech\"\u003eAllegro\u003c/a\u003e as a software engineer. After a while, I\nbecame a team leader again, and recently, another few years down the line, I went back to engineering yet again.\u003c/p\u003e\n\n\u003cp\u003eBoth above-mentioned posts make very good points, so I recommend you read them first. What I want to add on top of\nthem are my personal experiences and some tips on organizing a transition between a management and an individual\ncontributor role. The journey in the other direction (from developer to team leader) has been discussed in depth\nelsewhere, so I won’t delve into that.\u003c/p\u003e\n\n\u003ch2 id=\"why\"\u003eWhy\u003c/h2\u003e\n\n\u003cp\u003eWhy would I want to switch between developer and team leader roles? The problem is they are both interesting and have\n\u003ca href=\"/2019/06/allegro-culture-tech-leaders-meeting.html\"\u003etheir own highlights\u003c/a\u003e, but you can’t do both at the\nsame time. When you become a manager, not only do you have less time for technical tasks, but you also pretty much\nlose the ability to focus on these tasks even if you do find a time slot. This is because, like it or not, you end\nup with a \u003ca href=\"http://www.paulgraham.com/makersschedule.html\"\u003emanager’s schedule\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/img/articles/2023-08-22-management-engineering-acrobatics/flying-trapeze-performers.jpg\" alt=\"Circus performers on the flying trapeze, Public Domain image from https://commons.wikimedia.org/wiki/File:Programma_van_Circus_Krone_in_Rotterdam_drie_Alizes_,_vliegende_trapeze_met_o.a.,_Bestanddeelnr_910-4372.jpg\" class=\"small-image\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eOver time, your technical skills start deteriorating, and if you miss the right moment, you may find yourself at\na point of no return. Like a circus artist on a flying trapeze, you have to time your actions right to avoid\ndisaster. I think this metaphor fits the situation better than that of the pendulum, which moves in its own rhythm,\nindependent of external influences.\u003c/p\u003e\n\n\u003cp\u003eObviously, you need to ask yourself whether you actually want to prevent your technical skills from deteriorating. Some\npeople move on to management, wave goodbye to getting their hands dirty, and are completely fine with that. Some tinker\nwith technology in their spare time. As for me, I like technology and would not only prefer to not lose what I have\nlearned so far, but actually want to learn something new. However, due to a number of other hobbies and already\nspending more time in front of the screen than I would like, doing tech in the afternoons was not a viable option for\nme. Hence, the decision to make technology an important part of my job again.\u003c/p\u003e\n\n\u003ch2 id=\"how\"\u003eHow\u003c/h2\u003e\n\n\u003cp\u003eA crucial factor to take into account when planning such a change is that it will take time. If you take your\nteam seriously, you can’t just disappear overnight. You need to think ahead. Do not ask yourself “have I already\nlost my tech skills beyond repair?”. Ask yourself “how will my tech skills be a year from now?”.\u003c/p\u003e\n\n\u003cp\u003eAlso, keep a cool head. Just as when moving in the opposite direction, from engineer to manager, consider all\nconsequences, both positive and negative. It has been repeated many times that becoming a manager is not a promotion\n(being a lateral move to another career path), but in practice sometimes it is. In particular, it may come with a\nhigher level or salary. Make sure you check all details of your target role in order to avoid unpleasant surprises when\ngoing back. In my case, I was aiming for the Principal Software Engineer role, which is the same level as the Team\nLeader role at Allegro, so there were no issues in this regard.\u003c/p\u003e\n\n\u003cp\u003eWhen I started thinking about making the switch, once I had a rough idea of what I wanted, I talked to my superior.\nThis was an important step: it allowed him to plan ahead, and also to look for opportunities for making the\nreorganization easier. Some elements of the process would depend only on our actions, but some, such as finding a good\nreplacement team leader, would also depend on a number of factors outside our control. Knowing that my boss understood\nmy need, and supported it, mattered a lot, and made the wait and preparations easier.\u003c/p\u003e\n\n\u003cp\u003eChance favors the prepared mind, as Louis Pasteur supposedly said. There happened to be a team leader in\nanother part of the company who was thinking about moving on to a different area. Thanks to being aware of my plan,\nmy boss was able to grab the chance, and we had a perfect match. We discussed with the potential new leader the team\nand the project, and he found them interesting. We planned a transition period, as short as possible, but long enough\nfor me to transfer to him a reasonable part of my knowledge about the team and its work.\u003c/p\u003e\n\n\u003cp\u003eNow that we had a specific plan, we could tell the team. It was important to let everyone know as soon as possible, but\nnot before we had a specific plan. Without it, this information would only stir uncertainty. Apart\nfrom telling the team as a whole, I also talked to each person individually, in order to resolve any questions or doubts\nand to try to reduce any problems resulting from the transition as much as possible.\u003c/p\u003e\n\n\u003cp\u003eWaiting for the switch date, we kept meeting online with the new leader, transferring knowledge and preparing him for\nworking with the team. There’s actually quite a lot of stuff a leader needs to know: not only how the project\nworks on technical and business levels, but also current plans, who the stakeholders are and how to work with them,\nand each team member’s individual strengths and development plan. The new leader himself also started meeting\npeople he would now work with, both team members and our product’s stakeholders, and attending team meetings such as\nthe daily stand-up. Despite gradually moving on to other tasks after the switch date, I was still available to clarify\nany doubts, and our boss would also help out when necessary, so the new leader knew he would not be left on his own.\nWhile it required quite a bit of work, the switch went smoothly, and we didn’t notice any serious disturbance to the\nteam’s functioning.\u003c/p\u003e\n\n\u003ch2 id=\"the-aftermath\"\u003eThe Aftermath\u003c/h2\u003e\n\n\u003cp\u003eIt’s been several months since the switch now. Me changing back to a technical role has certainly required extra work,\nfor me, my boss, and the new team leader. Despite our best efforts, it probably put a little extra strain on the team as\nwell. Nonetheless, I think it was a win-win, even more so thanks to us being able to spot and exploit a happy\ncoincidence. I am glad to be closer to technology again, and the new leader also got to try something new, just as he\nwanted.\u003c/p\u003e\n\n\u003cp\u003eThere is one more subtle advantage to the whole process. When people leave the team, some knowledge inevitably gets\nlost. One of the reasons is \u003cem\u003etacit knowledge\u003c/em\u003e: there are always things you know, but are not aware of knowing. You can\nuse this knowledge when it’s needed, but you will probably not transfer it to others because you are not even aware of\nits existence in the first place. Removing someone from the team in a controlled manner as happened here (and being\nstill able to reach out to them if needed) causes such latent knowledge to be discovered, and once discovered, to be\npropagated. This causes a little disruption short-term, but in the long run it reduces\n\u003ca href=\"https://en.wikipedia.org/wiki/Information_silo\"\u003eknowledge silos\u003c/a\u003e and increases the\n\u003ca href=\"https://en.wikipedia.org/wiki/Bus_factor\"\u003ebus factor\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eWhen I first started thinking about going back to hands-on technical work for the second time, I had some doubts about\nhow much my technical skills had already deteriorated and how difficult it would be to go back. It seems I made it, but\nnot by much. Had I delayed by one more year, I might have really struggled. It’s not a matter of knowledge: theory,\nespecially generic things that do not change that fast with technology, is not lost so quickly. Also, while a team\nleader, I tried to stay in touch with technology by taking part in task refinement, architecture discussions, on-call\nrotation, etc.\u003c/p\u003e\n\n\u003cp\u003eHowever, I really felt, and to some degree still feel, a difference in practical, hands-on work, such as actually\nwriting code. There are many small quirks that you need to be aware of in order to accomplish things quickly that you\ndon’t even notice if you use them every day and know inside-out. Knowing all the little useful tools, the less often\nused features of your IDE, or what to do when something breaks unexpectedly, make a world of a difference, but this\npractical knowledge gets lost when not used and I had to rebuild it almost from scratch. Another thing that I still\nexperience is the difficulty in focusing on a single topic. Working on a manager’s schedule for several years has taken\nits toll, and now that I often have large contiguous blocks of time, I find myself not using them as effectively as I\ncould, because I have become accustomed to always doing multiple things at once and without a chance to stay focused\nanyway. It’s gradually getting better, but I still feel the impact, and this is probably my biggest surprise of the\nwhole process.\u003c/p\u003e\n\n\u003ch2 id=\"about-the-principal-software-engineer-role\"\u003eAbout the Principal Software Engineer role\u003c/h2\u003e\n\n\u003cp\u003eMy current role is that of Principal Software Engineer (PSE). It is a relatively new addition to the junior, mid,\nand senior roles we’ve had so far. It has gone through a number of revisions, and is still evolving. Most people in this\nrole come from a Senior Software Engineer background, so my case of getting there after being a Team Leader is a bit\nuntypical. At many companies, roles like this are called Staff Software Engineer or similar. While still an individual\ncontributor role, a PSE differs from a senior in several ways.\u003c/p\u003e\n\n\u003cp\u003eFirst of all, a PSE is expected to spend significant time on topics whose scope is much larger than a single team can\nhandle. Seniors can also do this, but it’s not a requirement for them. Such topics may be area-wide, such as planning a\nmajor change to a single subsystem’s architecture, or have a company-wide scope. Much work on this level consists of\ncoming up with ideas and discussing them while implementation is often left to others. So, while still technical, this\nrole encompasses less coding than that of a senior. Not very surprising given that generally moving up the career ladder\nmeans more coming up with ideas, teaching others, and planning work, while coding less yourself.\u003c/p\u003e\n\n\u003cp\u003eSecondly, a PSE should be very autonomous. Most PSEs are not members of regular development teams since they move from\ntask to task depending on where they can help most. This means you cooperate with more people from different parts of\nthe company, but you don’t have the few peers you work with every day that most people have. You don’t get a backlog\nof tasks to work on, but have to plan your work yourself. People do come to you, asking for support or doing something\nfor their project, but that’s just one of many inputs.\u003c/p\u003e\n\n\u003cp\u003eThirdly, since there are few PSEs compared to other positions, for each person the role is a little different. On one\nhand this means you can’t fully know what to expect when you start. On the other, you get to shape the role yourself,\nand personally I enjoy this flexibility.\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eI think the idea of swinging back and forth between engineering and management described in\n\u003ca href=\"https://charity.wtf/2017/05/11/the-engineer-manager-pendulum/\"\u003eThe Engineer/Manager Pendulum\u003c/a\u003e,\nis valid, and my own experience backs it up fully. One element which I want to additionally stress, however, is that\nthe switch is more like a flying trapeze than a pendulum: timing is crucial, and missing the right moment can have\nserious consequences. Becoming a Principal Software Engineer was a unique experience, both on a technical\nlevel and as my de facto last task as a team leader. Who knows what the future holds? Perhaps some time from now I’ll\ntake another swing on the flying trapeze and go back to management?\u003c/p\u003e\n","contentSnippet":"After six years as a Team Leader, I went back to hands-on engineering work, and I’m very happy about taking\nthis step. While it may appear surprising at first, it was a well-thought-out decision, and actually I’ve already\nperformed such a maneuver once before.\nBackground\nA few years ago I stumbled upon The Engineer/Manager Pendulum\nby Charity Majors, and the follow-up post Engineering Management: The Pendulum Or The Ladder.\nI found both pieces interesting, and quite in line with my own experiences: in my previous job some time earlier I\nhad been a team leader, but consciously joined Allegro as a software engineer. After a while, I\nbecame a team leader again, and recently, another few years down the line, I went back to engineering yet again.\nBoth above-mentioned posts make very good points, so I recommend you read them first. What I want to add on top of\nthem are my personal experiences and some tips on organizing a transition between a management and an individual\ncontributor role. The journey in the other direction (from developer to team leader) has been discussed in depth\nelsewhere, so I won’t delve into that.\nWhy\nWhy would I want to switch between developer and team leader roles? The problem is they are both interesting and have\ntheir own highlights, but you can’t do both at the\nsame time. When you become a manager, not only do you have less time for technical tasks, but you also pretty much\nlose the ability to focus on these tasks even if you do find a time slot. This is because, like it or not, you end\nup with a manager’s schedule.\n\nOver time, your technical skills start deteriorating, and if you miss the right moment, you may find yourself at\na point of no return. Like a circus artist on a flying trapeze, you have to time your actions right to avoid\ndisaster. I think this metaphor fits the situation better than that of the pendulum, which moves in its own rhythm,\nindependent of external influences.\nObviously, you need to ask yourself whether you actually want to prevent your technical skills from deteriorating. Some\npeople move on to management, wave goodbye to getting their hands dirty, and are completely fine with that. Some tinker\nwith technology in their spare time. As for me, I like technology and would not only prefer to not lose what I have\nlearned so far, but actually want to learn something new. However, due to a number of other hobbies and already\nspending more time in front of the screen than I would like, doing tech in the afternoons was not a viable option for\nme. Hence, the decision to make technology an important part of my job again.\nHow\nA crucial factor to take into account when planning such a change is that it will take time. If you take your\nteam seriously, you can’t just disappear overnight. You need to think ahead. Do not ask yourself “have I already\nlost my tech skills beyond repair?”. Ask yourself “how will my tech skills be a year from now?”.\nAlso, keep a cool head. Just as when moving in the opposite direction, from engineer to manager, consider all\nconsequences, both positive and negative. It has been repeated many times that becoming a manager is not a promotion\n(being a lateral move to another career path), but in practice sometimes it is. In particular, it may come with a\nhigher level or salary. Make sure you check all details of your target role in order to avoid unpleasant surprises when\ngoing back. In my case, I was aiming for the Principal Software Engineer role, which is the same level as the Team\nLeader role at Allegro, so there were no issues in this regard.\nWhen I started thinking about making the switch, once I had a rough idea of what I wanted, I talked to my superior.\nThis was an important step: it allowed him to plan ahead, and also to look for opportunities for making the\nreorganization easier. Some elements of the process would depend only on our actions, but some, such as finding a good\nreplacement team leader, would also depend on a number of factors outside our control. Knowing that my boss understood\nmy need, and supported it, mattered a lot, and made the wait and preparations easier.\nChance favors the prepared mind, as Louis Pasteur supposedly said. There happened to be a team leader in\nanother part of the company who was thinking about moving on to a different area. Thanks to being aware of my plan,\nmy boss was able to grab the chance, and we had a perfect match. We discussed with the potential new leader the team\nand the project, and he found them interesting. We planned a transition period, as short as possible, but long enough\nfor me to transfer to him a reasonable part of my knowledge about the team and its work.\nNow that we had a specific plan, we could tell the team. It was important to let everyone know as soon as possible, but\nnot before we had a specific plan. Without it, this information would only stir uncertainty. Apart\nfrom telling the team as a whole, I also talked to each person individually, in order to resolve any questions or doubts\nand to try to reduce any problems resulting from the transition as much as possible.\nWaiting for the switch date, we kept meeting online with the new leader, transferring knowledge and preparing him for\nworking with the team. There’s actually quite a lot of stuff a leader needs to know: not only how the project\nworks on technical and business levels, but also current plans, who the stakeholders are and how to work with them,\nand each team member’s individual strengths and development plan. The new leader himself also started meeting\npeople he would now work with, both team members and our product’s stakeholders, and attending team meetings such as\nthe daily stand-up. Despite gradually moving on to other tasks after the switch date, I was still available to clarify\nany doubts, and our boss would also help out when necessary, so the new leader knew he would not be left on his own.\nWhile it required quite a bit of work, the switch went smoothly, and we didn’t notice any serious disturbance to the\nteam’s functioning.\nThe Aftermath\nIt’s been several months since the switch now. Me changing back to a technical role has certainly required extra work,\nfor me, my boss, and the new team leader. Despite our best efforts, it probably put a little extra strain on the team as\nwell. Nonetheless, I think it was a win-win, even more so thanks to us being able to spot and exploit a happy\ncoincidence. I am glad to be closer to technology again, and the new leader also got to try something new, just as he\nwanted.\nThere is one more subtle advantage to the whole process. When people leave the team, some knowledge inevitably gets\nlost. One of the reasons is tacit knowledge: there are always things you know, but are not aware of knowing. You can\nuse this knowledge when it’s needed, but you will probably not transfer it to others because you are not even aware of\nits existence in the first place. Removing someone from the team in a controlled manner as happened here (and being\nstill able to reach out to them if needed) causes such latent knowledge to be discovered, and once discovered, to be\npropagated. This causes a little disruption short-term, but in the long run it reduces\nknowledge silos and increases the\nbus factor.\nWhen I first started thinking about going back to hands-on technical work for the second time, I had some doubts about\nhow much my technical skills had already deteriorated and how difficult it would be to go back. It seems I made it, but\nnot by much. Had I delayed by one more year, I might have really struggled. It’s not a matter of knowledge: theory,\nespecially generic things that do not change that fast with technology, is not lost so quickly. Also, while a team\nleader, I tried to stay in touch with technology by taking part in task refinement, architecture discussions, on-call\nrotation, etc.\nHowever, I really felt, and to some degree still feel, a difference in practical, hands-on work, such as actually\nwriting code. There are many small quirks that you need to be aware of in order to accomplish things quickly that you\ndon’t even notice if you use them every day and know inside-out. Knowing all the little useful tools, the less often\nused features of your IDE, or what to do when something breaks unexpectedly, make a world of a difference, but this\npractical knowledge gets lost when not used and I had to rebuild it almost from scratch. Another thing that I still\nexperience is the difficulty in focusing on a single topic. Working on a manager’s schedule for several years has taken\nits toll, and now that I often have large contiguous blocks of time, I find myself not using them as effectively as I\ncould, because I have become accustomed to always doing multiple things at once and without a chance to stay focused\nanyway. It’s gradually getting better, but I still feel the impact, and this is probably my biggest surprise of the\nwhole process.\nAbout the Principal Software Engineer role\nMy current role is that of Principal Software Engineer (PSE). It is a relatively new addition to the junior, mid,\nand senior roles we’ve had so far. It has gone through a number of revisions, and is still evolving. Most people in this\nrole come from a Senior Software Engineer background, so my case of getting there after being a Team Leader is a bit\nuntypical. At many companies, roles like this are called Staff Software Engineer or similar. While still an individual\ncontributor role, a PSE differs from a senior in several ways.\nFirst of all, a PSE is expected to spend significant time on topics whose scope is much larger than a single team can\nhandle. Seniors can also do this, but it’s not a requirement for them. Such topics may be area-wide, such as planning a\nmajor change to a single subsystem’s architecture, or have a company-wide scope. Much work on this level consists of\ncoming up with ideas and discussing them while implementation is often left to others. So, while still technical, this\nrole encompasses less coding than that of a senior. Not very surprising given that generally moving up the career ladder\nmeans more coming up with ideas, teaching others, and planning work, while coding less yourself.\nSecondly, a PSE should be very autonomous. Most PSEs are not members of regular development teams since they move from\ntask to task depending on where they can help most. This means you cooperate with more people from different parts of\nthe company, but you don’t have the few peers you work with every day that most people have. You don’t get a backlog\nof tasks to work on, but have to plan your work yourself. People do come to you, asking for support or doing something\nfor their project, but that’s just one of many inputs.\nThirdly, since there are few PSEs compared to other positions, for each person the role is a little different. On one\nhand this means you can’t fully know what to expect when you start. On the other, you get to shape the role yourself,\nand personally I enjoy this flexibility.\nSummary\nI think the idea of swinging back and forth between engineering and management described in\nThe Engineer/Manager Pendulum,\nis valid, and my own experience backs it up fully. One element which I want to additionally stress, however, is that\nthe switch is more like a flying trapeze than a pendulum: timing is crucial, and missing the right moment can have\nserious consequences. Becoming a Principal Software Engineer was a unique experience, both on a technical\nlevel and as my de facto last task as a team leader. Who knows what the future holds? Perhaps some time from now I’ll\ntake another swing on the flying trapeze and go back to management?","guid":"https://blog.allegro.tech/2023/08/management-engineering-acrobatics.html","categories":["tech","coding","management","developer","team leader","career path"],"isoDate":"2023-08-21T22:00:00.000Z","thumbnail":"images/post-headers/default.jpg"}],"jobs":[{"id":"743999948427702","name":"Integration Engineer","uuid":"6861c4c8-f07a-4adb-817b-2d94c06d32f5","jobAdId":"22b63dc3-61fa-488b-b1cd-ef8588ccfe28","defaultJobAd":true,"refNumber":"REF2138N","company":{"identifier":"Allegro","name":"Allegro"},"releasedDate":"2023-12-04T13:24:30.613Z","location":{"city":"Warsaw, Poznań, Cracow, Gdańsk, Wroclaw","country":"pl","remote":false},"industry":{"id":"internet","label":"Internet"},"department":{"id":"2572770","label":"IT - Software Development"},"function":{"id":"information_technology","label":"Information Technology"},"typeOfEmployment":{"id":"permanent","label":"Full-time"},"experienceLevel":{"id":"mid_senior_level","label":"Mid-Senior Level"},"customField":[{"fieldId":"58c15608e4b01d4b19ddf790","fieldLabel":"Recruitment Process","valueId":"ed4682c7-33c9-41c2-8d13-428ed39046f5","valueLabel":"Tech. Engineer - IC"},{"fieldId":"6406f92e638cbb2f415a94a9","fieldLabel":"Job Area","valueId":"e8731ea4-48a9-476d-ab1d-9a40eb3426f1","valueLabel":"Technology"},{"fieldId":"COUNTRY","fieldLabel":"Country","valueId":"pl","valueLabel":"Poland"},{"fieldId":"61583054f15cea434e0be36f","fieldLabel":"Career Level","valueId":"3976147c-fe25-42a8-8c97-78273250960b","valueLabel":"4"},{"fieldId":"58c13159e4b01d4b19ddf729","fieldLabel":"Department","valueId":"2572770","valueLabel":"IT - Software Development"},{"fieldId":"58c13159e4b01d4b19ddf728","fieldLabel":"Brands","valueId":"4ccb4fab-6c3f-4ed0-9140-8533fe17447f","valueLabel":"Allegro sp. z o.o."},{"fieldId":"61582f70e72a6b6d239c9857","fieldLabel":"Area","valueId":"76599a72-f283-4550-9303-52e2e0eb6e32","valueLabel":"Technology"}],"ref":"https://api.smartrecruiters.com/v1/companies/allegro/postings/743999948427702","creator":{"name":"Wiktoria Mitruk"},"language":{"code":"en","label":"English","labelNative":"English (US)"}},{"id":"743999948395138","name":"Software Engineer (.NET) - Allegro Pay","uuid":"e19d2ead-31e1-461c-a8b4-ae5b734d1806","jobAdId":"64d12e40-8ee1-468f-8e95-52bff85e0d14","defaultJobAd":true,"refNumber":"REF3170Y","company":{"identifier":"Allegro","name":"Allegro"},"releasedDate":"2023-12-04T09:50:34.747Z","location":{"city":"Warsaw","country":"pl","remote":false},"industry":{"id":"internet","label":"Internet"},"department":{"id":"2572770","label":"IT - Software Development"},"function":{"id":"information_technology","label":"Information Technology"},"typeOfEmployment":{"id":"permanent","label":"Full-time"},"experienceLevel":{"id":"mid_senior_level","label":"Mid-Senior Level"},"customField":[{"fieldId":"58c15608e4b01d4b19ddf790","fieldLabel":"Recruitment Process","valueId":"ed4682c7-33c9-41c2-8d13-428ed39046f5","valueLabel":"Tech. Engineer - IC"},{"fieldId":"6406f92e638cbb2f415a94a9","fieldLabel":"Job Area","valueId":"e8731ea4-48a9-476d-ab1d-9a40eb3426f1","valueLabel":"Technology"},{"fieldId":"COUNTRY","fieldLabel":"Country","valueId":"pl","valueLabel":"Poland"},{"fieldId":"61583054f15cea434e0be36f","fieldLabel":"Career Level","valueId":"3c97f53f-19c2-4a25-9eb1-513f9fb38b80","valueLabel":"3-5"},{"fieldId":"58c13159e4b01d4b19ddf729","fieldLabel":"Department","valueId":"2572770","valueLabel":"IT - Software Development"},{"fieldId":"58c13159e4b01d4b19ddf728","fieldLabel":"Brands","valueId":"9c8396d4-11a6-443c-897c-15f29221a3fd","valueLabel":"Allegro Pay sp. z o.o."},{"fieldId":"61582f70e72a6b6d239c9857","fieldLabel":"Area","valueId":"76599a72-f283-4550-9303-52e2e0eb6e32","valueLabel":"Technology"}],"ref":"https://api.smartrecruiters.com/v1/companies/allegro/postings/743999948395138","creator":{"name":"Wiktoria Mitruk"},"language":{"code":"en","label":"English","labelNative":"English (US)"}},{"id":"743999947819422","name":"DevOps Engineer (Azure / .NET) - Allegro Pay","uuid":"db47553d-b8da-423a-a2dc-3efe85402009","jobAdId":"00657dd7-dbfa-4edf-abd3-022ac21aa5da","defaultJobAd":true,"refNumber":"REF4210C","company":{"identifier":"Allegro","name":"Allegro"},"releasedDate":"2023-11-30T13:21:18.240Z","location":{"city":"Warsaw","country":"pl","remote":false},"industry":{"id":"internet","label":"Internet"},"department":{"id":"2572770","label":"IT - Software Development"},"function":{"id":"information_technology","label":"Information Technology"},"typeOfEmployment":{"id":"permanent","label":"Full-time"},"experienceLevel":{"id":"mid_senior_level","label":"Mid-Senior Level"},"customField":[{"fieldId":"58c15608e4b01d4b19ddf790","fieldLabel":"Recruitment Process","valueId":"ed4682c7-33c9-41c2-8d13-428ed39046f5","valueLabel":"Tech. Engineer - IC"},{"fieldId":"6406f92e638cbb2f415a94a9","fieldLabel":"Job Area","valueId":"e8731ea4-48a9-476d-ab1d-9a40eb3426f1","valueLabel":"Technology"},{"fieldId":"COUNTRY","fieldLabel":"Country","valueId":"pl","valueLabel":"Poland"},{"fieldId":"61583054f15cea434e0be36f","fieldLabel":"Career Level","valueId":"3c97f53f-19c2-4a25-9eb1-513f9fb38b80","valueLabel":"3-5"},{"fieldId":"58c13159e4b01d4b19ddf729","fieldLabel":"Department","valueId":"2572770","valueLabel":"IT - Software Development"},{"fieldId":"58c13159e4b01d4b19ddf728","fieldLabel":"Brands","valueId":"9c8396d4-11a6-443c-897c-15f29221a3fd","valueLabel":"Allegro Pay sp. z o.o."},{"fieldId":"61582f70e72a6b6d239c9857","fieldLabel":"Area","valueId":"76599a72-f283-4550-9303-52e2e0eb6e32","valueLabel":"Technology"}],"ref":"https://api.smartrecruiters.com/v1/companies/allegro/postings/743999947819422","creator":{"name":"Martyna Stafa"},"language":{"code":"en","label":"English","labelNative":"English (US)"}},{"id":"743999947605953","name":"Mobile Software Engineer (Android)-Allegro Pay","uuid":"40d565e9-daf9-4c6f-a908-4e44c3ecc0f8","jobAdId":"fe5b9e62-14a4-4cb9-aecf-639cc6a12380","defaultJobAd":true,"refNumber":"REF4603V","company":{"identifier":"Allegro","name":"Allegro"},"releasedDate":"2023-11-29T11:33:59.238Z","location":{"city":"Warsaw","region":"Masovian Voivodeship","country":"pl","remote":false,"latitude":"52.2296756","longitude":"21.0122287"},"industry":{"id":"internet","label":"Internet"},"department":{"id":"2572770","label":"IT - Software Development"},"function":{"id":"information_technology","label":"Information Technology"},"typeOfEmployment":{"id":"permanent","label":"Full-time"},"experienceLevel":{"id":"mid_senior_level","label":"Mid-Senior Level"},"customField":[{"fieldId":"58c15608e4b01d4b19ddf790","fieldLabel":"Recruitment Process","valueId":"ed4682c7-33c9-41c2-8d13-428ed39046f5","valueLabel":"Tech. Engineer - IC"},{"fieldId":"6406f92e638cbb2f415a94a9","fieldLabel":"Job Area","valueId":"e8731ea4-48a9-476d-ab1d-9a40eb3426f1","valueLabel":"Technology"},{"fieldId":"COUNTRY","fieldLabel":"Country","valueId":"pl","valueLabel":"Poland"},{"fieldId":"61583054f15cea434e0be36f","fieldLabel":"Career Level","valueId":"3c97f53f-19c2-4a25-9eb1-513f9fb38b80","valueLabel":"3-5"},{"fieldId":"58c13159e4b01d4b19ddf729","fieldLabel":"Department","valueId":"2572770","valueLabel":"IT - Software Development"},{"fieldId":"58c13159e4b01d4b19ddf728","fieldLabel":"Brands","valueId":"9c8396d4-11a6-443c-897c-15f29221a3fd","valueLabel":"Allegro Pay sp. z o.o."},{"fieldId":"61582f70e72a6b6d239c9857","fieldLabel":"Area","valueId":"76599a72-f283-4550-9303-52e2e0eb6e32","valueLabel":"Technology"}],"ref":"https://api.smartrecruiters.com/v1/companies/allegro/postings/743999947605953","creator":{"name":"Dominika Fujarowicz"},"language":{"code":"en","label":"English","labelNative":"English (US)"}},{"id":"743999947036804","name":"Mobile Software Engineer (iOS)-Allegro Pay","uuid":"d0be06ea-845a-47ab-b95b-1d1143f4ae0b","jobAdId":"c849a9ac-95a8-468f-b7b5-240a1f3d3017","defaultJobAd":true,"refNumber":"REF4604N","company":{"identifier":"Allegro","name":"Allegro"},"releasedDate":"2023-11-27T10:47:40.171Z","location":{"city":"Warsaw","region":"Masovian Voivodeship","country":"pl","remote":false,"latitude":"52.2296756","longitude":"21.0122287"},"industry":{"id":"internet","label":"Internet"},"department":{"id":"2572770","label":"IT - Software Development"},"function":{"id":"information_technology","label":"Information Technology"},"typeOfEmployment":{"id":"permanent","label":"Full-time"},"experienceLevel":{"id":"mid_senior_level","label":"Mid-Senior Level"},"customField":[{"fieldId":"58c15608e4b01d4b19ddf790","fieldLabel":"Recruitment Process","valueId":"ed4682c7-33c9-41c2-8d13-428ed39046f5","valueLabel":"Tech. Engineer - IC"},{"fieldId":"6406f92e638cbb2f415a94a9","fieldLabel":"Job Area","valueId":"e8731ea4-48a9-476d-ab1d-9a40eb3426f1","valueLabel":"Technology"},{"fieldId":"COUNTRY","fieldLabel":"Country","valueId":"pl","valueLabel":"Poland"},{"fieldId":"61583054f15cea434e0be36f","fieldLabel":"Career Level","valueId":"3c97f53f-19c2-4a25-9eb1-513f9fb38b80","valueLabel":"3-5"},{"fieldId":"58c13159e4b01d4b19ddf729","fieldLabel":"Department","valueId":"2572770","valueLabel":"IT - Software Development"},{"fieldId":"58c13159e4b01d4b19ddf728","fieldLabel":"Brands","valueId":"9c8396d4-11a6-443c-897c-15f29221a3fd","valueLabel":"Allegro Pay sp. z o.o."},{"fieldId":"61582f70e72a6b6d239c9857","fieldLabel":"Area","valueId":"76599a72-f283-4550-9303-52e2e0eb6e32","valueLabel":"Technology"}],"ref":"https://api.smartrecruiters.com/v1/companies/allegro/postings/743999947036804","creator":{"name":"Dominika Fujarowicz"},"language":{"code":"en","label":"English","labelNative":"English (US)"}}],"events":[{"created":1701092071000,"duration":7200000,"id":"297614064","name":"Allegro Tech Talks #40 - Testy: dynamiczne dashboardy \u0026 optymalizacja pracy","date_in_series_pattern":false,"status":"upcoming","time":1701968400000,"local_date":"2023-12-07","local_time":"18:00","updated":1701092071000,"utc_offset":3600000,"waitlist_count":0,"yes_rsvp_count":13,"venue":{"id":27528185,"name":"Allegro Kraków Office","lat":50.06517028808594,"lon":19.951927185058594,"repinned":true,"address_1":"Lubicz Park A (5 piętro)","address_2":"ul. Lubicz 23","city":"Kraków","country":"pl","localized_country_name":"Poland"},"is_online_event":false,"eventType":"PHYSICAL","group":{"created":1425052059000,"name":"allegro Tech","id":18465254,"join_mode":"open","lat":52.2599983215332,"lon":21.020000457763672,"urlname":"allegrotech","who":"Techs","localized_location":"Warsaw, Poland","state":"","country":"pl","region":"en_US","timezone":"Europe/Warsaw"},"link":"https://www.meetup.com/allegrotech/events/297614064/","description":"**➡ Rejestracja:** [https://app.evenea.pl/event/allegro-tech-talk-40/](https://app.evenea.pl/event/allegro-tech-talk-40/) Jeszcze przed świętami zapraszamy Was na #40 wydarzenie z serii Allegro Tech Talk, podczas których dzielimy się wiedzą, wzajemnie inspirujemy oraz integrujemy…","how_to_find_us":"Biuro Allegro znajduje się w Centrum Biurowym Lubicz. \n\nObok budynku znajduje się przystanek Lubicz. Przy przystanku zatrzymują się tramwaje 2, 4, 10, 14, 20, 52, 62, 64 oraz autobusy: 124, 152, 424, 601, 611, 662, 664.\n\n","visibility":"public","member_pay_fee":false},{"created":1700495058000,"duration":7200000,"id":"297480100","name":"Allegro Tech Talks #39 - Big Data: o podejściu do pracy z danymi","date_in_series_pattern":false,"status":"past","time":1701363600000,"local_date":"2023-11-30","local_time":"18:00","updated":1701377876000,"utc_offset":3600000,"waitlist_count":0,"yes_rsvp_count":50,"venue":{"id":27549223,"name":"Allegro Warsaw Office","lat":52.23224639892578,"lon":20.992111206054688,"repinned":true,"address_1":"ul. Żelazna 51/53","city":"Warszawa","country":"pl","localized_country_name":"Poland"},"is_online_event":false,"eventType":"PHYSICAL","group":{"created":1425052059000,"name":"allegro Tech","id":18465254,"join_mode":"open","lat":52.2599983215332,"lon":21.020000457763672,"urlname":"allegrotech","who":"Techs","localized_location":"Warsaw, Poland","state":"","country":"pl","region":"en_US","timezone":"Europe/Warsaw"},"link":"https://www.meetup.com/allegrotech/events/297480100/","description":"**Rejestracja: [https://app.evenea.pl/event/allegro-tech-talk-39/](https://app.evenea.pl/event/allegro-tech-talk-39/)** Bądźcie z nami podczas #39 wydarzenia z serii **Allegro Tech Talk**, podczas których dzielimy się wiedzą, wzajemnie inspirujemy oraz integrujemy podczas rozmów przy…","how_to_find_us":"Biuro Allegro znajduje się w kompleksie Fabryki Norblina (wejście Plater 3 od ul. Żelaznej). W niedalekiej odległości znajdują się dwie stacje metra linii M2, Rondo Daszyńskiego i Rondo ONZ. Autobusy, tramwaje i inne środki transportu sprawdzisz też na: https://fabrykanorblina.pl/dojazd","visibility":"public","member_pay_fee":false},{"created":1685697967000,"duration":7200000,"id":"293929321","name":"Allegro Tech Talks #38 - Mobile: o iOS bez spinki","date_in_series_pattern":false,"status":"past","time":1686760200000,"local_date":"2023-06-14","local_time":"18:30","updated":1686773845000,"utc_offset":7200000,"waitlist_count":0,"yes_rsvp_count":17,"venue":{"id":27549223,"name":"Allegro Warsaw Office","lat":0,"lon":0,"repinned":true,"address_1":"ul. Żelazna 51/53","city":"Warszawa","country":"pl","localized_country_name":"Poland"},"is_online_event":false,"eventType":"PHYSICAL","group":{"created":1425052059000,"name":"allegro Tech","id":18465254,"join_mode":"open","lat":52.2599983215332,"lon":21.020000457763672,"urlname":"allegrotech","who":"Techs","localized_location":"Warsaw, Poland","state":"","country":"pl","region":"en_US","timezone":"Europe/Warsaw"},"link":"https://www.meetup.com/allegrotech/events/293929321/","description":"**➡ Rejestracja:** [https://app.evenea.pl/event/allegro-tech-talk-38/](https://app.evenea.pl/event/allegro-tech-talk-38/) Ostatnie przed przerwą wakacyjną, stacjonarne spotkanie z cyklu Allegro Tech Talks, na których dzielimy się wiedzą, wzajemnie inspirujemy oraz integrujemy podczas rozmów…","how_to_find_us":"Biuro Allegro znajduje się w kompleksie Fabryki Norblina (wejście Plater 3 od ul. Żelaznej). W niedalekiej odległości znajdują się dwie stacje metra linii M2, Rondo Daszyńskiego i Rondo ONZ. Autobusy, tramwaje i inne środki transportu sprawdzisz też na: https://fabrykanorblina.pl/dojazd","visibility":"public","member_pay_fee":false},{"created":1678978572000,"duration":111600000,"id":"292278882","name":"UX Research Confetti - III edycja ","date_in_series_pattern":false,"status":"past","time":1684915200000,"local_date":"2023-05-24","local_time":"10:00","updated":1685029049000,"utc_offset":7200000,"waitlist_count":0,"yes_rsvp_count":33,"is_online_event":true,"eventType":"ONLINE","group":{"created":1425052059000,"name":"allegro Tech","id":18465254,"join_mode":"open","lat":52.2599983215332,"lon":21.020000457763672,"urlname":"allegrotech","who":"Techs","localized_location":"Warsaw, Poland","state":"","country":"pl","region":"en_US","timezone":"Europe/Warsaw"},"link":"https://www.meetup.com/allegrotech/events/292278882/","description":"**Rejestracja na wydarzenie ➡ [https://app.evenea.pl/event/ux-research-confetti-3/]( https://app.evenea.pl/event/ux-research-confetti-3/ )**[ ]( https://app.evenea.pl/event/ux-research-confetti-3/ ) **🎉 Przedstawiamy 3. edycję UX Research Confetti organizowaną przez Allegro - bezpłatną, polską konferencję poświęconą badaniom…","visibility":"public","member_pay_fee":false}],"podcasts":[{"title":"MBox: server-driven UI dla aplikacji mobilnych","link":"https://podcast.allegro.tech/mbox-server-driven-ui-dla-aplikacji-mobilnych/","pubDate":"Thu, 16 Nov 2023 00:00:00 GMT","content":"Czym jest i jak powstał MBox: wewnętrzna platforma server-driven UI dla aplikacji mobilnych w Allegro? Skąd wziął się pomysł na to rozwiązanie i na jakie bolączki odpowiada? Dlaczego zdecydowaliśmy się na budowanie tego typu rozwiązania in-house i z jakimi wyzwaniami mierzyliśmy się w procesie tworzenia? Co wyróżnia zespoły pracujące nad tym narzędziem i jak pracuje im się bez Product Ownera? Posłuchajcie siódmego odcinka Allegro Tech Podcast z udziałem Pauliny Sadowskiej i Tomasza Gębarowskiego - Managerów w obszarze Technical Platform Services w Allegro.","contentSnippet":"Czym jest i jak powstał MBox: wewnętrzna platforma server-driven UI dla aplikacji mobilnych w Allegro? Skąd wziął się pomysł na to rozwiązanie i na jakie bolączki odpowiada? Dlaczego zdecydowaliśmy się na budowanie tego typu rozwiązania in-house i z jakimi wyzwaniami mierzyliśmy się w procesie tworzenia? Co wyróżnia zespoły pracujące nad tym narzędziem i jak pracuje im się bez Product Ownera? Posłuchajcie siódmego odcinka Allegro Tech Podcast z udziałem Pauliny Sadowskiej i Tomasza Gębarowskiego - Managerów w obszarze Technical Platform Services w Allegro.","guid":"https://podcast.allegro.tech/mbox-server-driven-ui-dla-aplikacji-mobilnych/","isoDate":"2023-11-16T00:00:00.000Z"},{"title":"O chatbotach i ich wpływie na Allegro","link":"https://podcast.allegro.tech/o-chatbotach-i-ich-wplywie-na-allegro/","pubDate":"Wed, 11 Oct 2023 00:00:00 GMT","content":"Jakie procesy automatyzujemy w Allegro i co warto o nich wiedzieć w kontekście obszaru Customer Experience? W czym pomagają nam chatboty, jak je rozwijamy i dbamy o ich jakość? Kim są Allina oraz Albert i co mają wspólnego z automatyzacją? Za jakie rozwiązania otrzymaliśmy nagrodę hiperautomatyzacji? O tym wszystkim posłuchacie w odcinku z udziałem Rafała Gajewskiego - Managera w obszarze IT Services w Allegro.","contentSnippet":"Jakie procesy automatyzujemy w Allegro i co warto o nich wiedzieć w kontekście obszaru Customer Experience? W czym pomagają nam chatboty, jak je rozwijamy i dbamy o ich jakość? Kim są Allina oraz Albert i co mają wspólnego z automatyzacją? Za jakie rozwiązania otrzymaliśmy nagrodę hiperautomatyzacji? O tym wszystkim posłuchacie w odcinku z udziałem Rafała Gajewskiego - Managera w obszarze IT Services w Allegro.","guid":"https://podcast.allegro.tech/o-chatbotach-i-ich-wplywie-na-allegro/","isoDate":"2023-10-11T00:00:00.000Z"},{"title":"O roli analityków biznesowych w Allegro","link":"https://podcast.allegro.tech/o-roli-analitykow-biznesowych-w-allegro/","pubDate":"Thu, 24 Aug 2023 00:00:00 GMT","content":"Czym zajmują się analitycy danych w Allegro i za jakie projekty odpowiadają? Z jakich rodzajów danych i narzędzi korzystają w codziennej pracy? Jakie (przykładowe) obszary tematyczne pokrywamy danymi, które analizujemy w Allegro? Jakich umiejętności szukamy u analityków biznesowych w Allegro i jak można do nas dołączyć? O roli analityków biznesowych i pracy w skali Allegro opowiadają Jakub Król i Mateusz Falkowski - Senior Data Analysts w Allegro.","contentSnippet":"Czym zajmują się analitycy danych w Allegro i za jakie projekty odpowiadają? Z jakich rodzajów danych i narzędzi korzystają w codziennej pracy? Jakie (przykładowe) obszary tematyczne pokrywamy danymi, które analizujemy w Allegro? Jakich umiejętności szukamy u analityków biznesowych w Allegro i jak można do nas dołączyć? O roli analityków biznesowych i pracy w skali Allegro opowiadają Jakub Król i Mateusz Falkowski - Senior Data Analysts w Allegro.","guid":"https://podcast.allegro.tech/o-roli-analitykow-biznesowych-w-allegro/","isoDate":"2023-08-24T00:00:00.000Z"},{"title":"O społeczności Allegro Tech i rozwoju inżynierów w Allegro","link":"https://podcast.allegro.tech/o-spolecznosci-allegro-tech-i-rozwoju-inzynierow-w-allegro/","pubDate":"Thu, 27 Jul 2023 00:00:00 GMT","content":"Na czym polega rola Principal Software Engineera w Allegro oraz co ma wspólnego z rozwijaniem siebie i dzieleniem się wiedzą? Co warto wiedzieć o turystyce, która pojawia się niemal w każdym odcinku naszych podcastów? Na czym polega, kto, kiedy i jak może z niej skorzystać? Jak pracujemy z talentami Gallupa (także w zespołach technicznych)?  Co dają nam wewnętrzne DevDays, hackhathony, gildie, meetupy, konferencje i jak jeszcze wymieniamy się doświadczeniami? Czym jest Allegro Tech Meeting i jaka idea mu przyświeca? O społeczności Allegro Tech i możliwościach rozwoju w Allegro z perspektywy inżynierów rozmawialiśmy z Marcinem Turkiem i Michałem Kosmulskim.","contentSnippet":"Na czym polega rola Principal Software Engineera w Allegro oraz co ma wspólnego z rozwijaniem siebie i dzieleniem się wiedzą? Co warto wiedzieć o turystyce, która pojawia się niemal w każdym odcinku naszych podcastów? Na czym polega, kto, kiedy i jak może z niej skorzystać? Jak pracujemy z talentami Gallupa (także w zespołach technicznych)?  Co dają nam wewnętrzne DevDays, hackhathony, gildie, meetupy, konferencje i jak jeszcze wymieniamy się doświadczeniami? Czym jest Allegro Tech Meeting i jaka idea mu przyświeca? O społeczności Allegro Tech i możliwościach rozwoju w Allegro z perspektywy inżynierów rozmawialiśmy z Marcinem Turkiem i Michałem Kosmulskim.","guid":"https://podcast.allegro.tech/o-spolecznosci-allegro-tech-i-rozwoju-inzynierow-w-allegro/","isoDate":"2023-07-27T00:00:00.000Z"}]},"__N_SSG":true},"page":"/","query":{},"buildId":"vRW38edfpPonFFwKo-sNV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>